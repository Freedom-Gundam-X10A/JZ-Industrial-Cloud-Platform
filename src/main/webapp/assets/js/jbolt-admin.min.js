var jboltWindow=$(window);var jboltDocument=$(document);var jboltBody=$("body");var jboltWindowHeight=jboltWindow.height();var mainPjaxContainerId="#jbolt-container";var mainPjaxContainer=$(mainPjaxContainerId);var summernote_img_uploadurl="/admin/summernote/upload/image/";var hasImportSelect2=false;var g=function(a){return"string"==typeof a?document.getElementById(a):a};var isOk=function(a){return a&&a.length>0};var ImageViewerUtil={initViewers:function(b){if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){this.initViewer(b.eq(c))}},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-imgviewer]");if(!isOk(a)){return false}this.initViewers(a)},initViewer:function(d){var c=d[0].tagName.toLowerCase()=="img";if(c){var b=d.data("orignurl");if(b){d.viewer({navbar:false,url:"data-orignurl"})}else{d.viewer({navbar:false})}}else{var a=d.data("useorign");if(a){d.viewer({url:"data-orignurl"})}else{d.viewer()}}}};function processAutocompleteItem(e,d){var f="";if(d.indexOf(",")==-1){f=e[d];if(!f&&(f=="undefined"||f==undefined)){if(d!="text"){f=e["text"];if(!f&&(f=="undefined"||f==undefined)){f=e["name"];if(!f&&(f=="undefined"||f==undefined)){f=e["title"]}}}else{if(!f&&(f=="undefined"||f==undefined)){f=e["name"];if(!f&&(f=="undefined"||f==undefined)){f=e["title"]}}}}return"<span style='width:100%;'>"+f+"</span>"}var a=d.split(",");var c;for(var b in a){c=e[a[b]];f=f+"<span>"+(c?c:"-")+"</span>"}return f}var AutocompleteUtil={initInputs:function(b){if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){this.initInput(b.eq(c))}},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("input[data-autocomplete]");if(!isOk(a)){return false}this.initInputs(a)},defaultFormat:function(b,a){return processAutocompleteItem(b,a)},processGetSyncEditor:function(c,b){var d=c.data("sync-editor-id");if(!d){return null}var h=c.data("sync-editor-type");var a=c.data("sync-attr");var e=document.createElement("input");var f=$(e);f.data("editor-id",d);f.data("editor-type",h);f.data("value-attr",a?a:b);return f},processGetAutocomplateHiddens:function(c){var b=new Array();if(c){if(c.indexOf(",")==-1){b.push($("#"+c))}else{var a=c.split(",");for(var d in a){b.push($("#"+a[d]))}}}return b},changeHiddenInputValue:function(c,f,d){var e=c.data("value-attr");var h="";if(e){if(e=="value"){h=h+(d?d:"")}else{h=h+f[e]}}else{h=h+(d?d:"")}var a=c.data("editor-type");if(a){var b=c.data("editor-id");if(a=="neditor"){UE.getEditor(b).execCommand("insertHtml",h)}else{if(a=="summernote"){$("#"+b).summernote("code",h)}else{c.val(h)}}}else{c.val(h)}},changeHiddenInputsValue:function(a,d,c){if(isArray(a)){for(var b in a){this.changeHiddenInputValue(a[b],d,c)}}else{this.changeHiddenInputValue(a,d,c)}},clearHiddenInputsValue:function(a){if(isArray(a)){for(var b in a){a[b].val("")}}else{a.val("")}},initInput:function(input){var url=input.data("url");if(!url){LayerMsgBox.alert("autocomplete组件未设置data-url属性",2);return false}var hiddenInputId=input.data("hiddeninput");var synceditor_id=input.data("sync-editor-id");if(!hiddenInputId&&!synceditor_id){LayerMsgBox.alert("autocomplete组件未设置data-hiddeninput或data-sync-editor-id属性,需关联指定的隐藏域或者editor",2);return false}var that=this,syncInputArray=new Array(),width=input.data("width"),widthAuto=false,text_attr=input.data("text-attr"),value_attr=input.data("value-attr"),column_attr=input.data("column-attr"),formatHandler=input.data("format-handler"),handler=input.data("handler"),limit=input.data("limit");if(!limit){limit=100}if(!width){width=parseInt(input.css("width"));widthAuto=true}if(!text_attr){text_attr="text"}if(!value_attr){value_attr="value"}if(!column_attr){column_attr=text_attr}if(column_attr.indexOf(",")!=-1&&widthAuto){var arr=column_attr.split(",");var autoW=(arr.length+1)*90;if(autoW>width){width=autoW}}var hiddenInput=that.processGetAutocomplateHiddens(hiddenInputId),editor=that.processGetSyncEditor(input,value_attr);if(editor){hiddenInput.push(editor)}if(hiddenInput.length==0){LayerMsgBox.alert("请关联指定的正确的隐藏域或者editor",2);return false}input.autocomplete(url,{minChars:0,width:width,scrollHeight:300,matchContains:true,autoFill:false,matchSubset:false,mustMatch:false,dataType:"json",max:limit,parse:function(res){var rows=[];if(!res||(!res.data)){return rows}var datas=res.data,size=datas.length,text,value;for(var i=0;i<size;i++){text=processOptionText(datas[i],text_attr);value=processOptionValue(datas[i],value_attr);rows[rows.length]={data:datas[i],value:value,result:text}}return rows},formatItem:function(row,i,max){return that.defaultFormat(row,column_attr)}}).result(function(e,data,value,sec){that.changeHiddenInputsValue(hiddenInput,data,value);if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(input,hiddenInput,value)}}}).bind("unmatch",function(){input.val("");that.clearHiddenInputsValue(hiddenInput);if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(input,hiddenInput,value)
}}}).blur(function(){if(isArray(hiddenInput)){var clear=true,hinput;for(var i in hiddenInput){hinput=hiddenInput[i];if($.trim(hinput.val())){clear=false}}if(clear){input.val("")}}else{if(hiddenInput.val()==""){input.val("")}}}).on("input",function(){that.clearHiddenInputsValue(hiddenInput)})}};var JBoltLayerUtil={init:function(){var a=this;jboltBody.on("click","[data-jboltlayertrigger]",function(b){b.preventDefault();b.stopPropagation();a.open($(this));return false}).on("click","[data-closejboltlayer]",function(b){b.preventDefault();b.stopPropagation();a.close();return false}).on("click",".jbolt_layer_portal",function(b){b.stopPropagation()}).on("click",".jbolt_admin_main",function(b){a.close()})},open:function(c){var b=c.attr("href");if(!b){b=c.data("url")}if(!b){LayerMsgBox.alert("jboltlayertrigger未设置URL",2);return false}var j=$("#jbolt_layer");if(j&&j.length==1){j.remove()}var h=c.attr("id");if(!h){h=randomId();c.attr("id",h)}var f=c.data("top");if(!f&&f!=0){f=0}var i=c.data("height");if(i){if(f==0){f=jboltWindowHeight-i;if(f<0){f=0}}}var a=true;if(c[0].hasAttribute("data-noclose")){a=false}var d=c[0].hasAttribute("data-nomask");var e='<div data-triggerid="'+h+'" class="jbolt_layer '+(d?" nomask ":"")+(a?"":" noclose ")+'" data-closejboltlayer id="jbolt_layer"><div class="jbolt_layer_portal"  style="top:'+f+'px;"   data-ajaxportal  data-url="'+b+'"></div></div>';jboltBody.append(e);if(a){$("#jbolt_layer").append('<a data-closejboltlayer  style="top:'+f+'px;"  class="jbolt_layer_close">&times;</a>')}this.load();this.showOpenAnimate(c)},load:function(b){var c=$("#jbolt_layer");if(c&&c.length==1){var a=c.find(".jbolt_layer_portal");if(b){a.ajaxPortal(true,b,true)}else{a.ajaxPortal()}}},close:function(){var c=this;var d=$("#jbolt_layer");if(d&&d.length==1){var e=d.data("triggerid");var a=$("#"+e);var h=a.attr("data-confirm");var f=(typeof(h)!="undefined");if(f){var b=a.data("confirm");if(!b){b="确认关闭?"}LayerMsgBox.confirm(b,function(){c.showCloseAnimateAndRemove(a,d)})}else{c.showCloseAnimateAndRemove(a,d)}}},showCloseAnimateAndRemove:function(c,d){var b=c.data("dir");if(!b){b="right"}var a=d.find(".jbolt_layer_portal");var e=d.find(".jbolt_layer_close");if(b=="right"){a.css({width:"0px",right:"0px"});e.css({width:"0px",right:"0px"})}else{a.css({left:"0px",width:"0px"});e.css({left:"0px",width:"0px"})}d.fadeOut(300,function(){d.remove()})},showOpenAnimate:function(c){var i=$("#jbolt_layer");if(i&&i.length==1){i.fadeIn(200);var h=i.find(".jbolt_layer_portal");var j=i.find(".jbolt_layer_close");var e=c.data("dir");if(!e){e="right"}if(i.hasClass("nomask")){i.addClass(e)}var a=c.data("width");var f=jboltWindow.width();if(!a){a=f/2;if(a<900){a=900}else{if(a>1360){a=1360}}}if(e=="right"){var d=(f-a)+"px";h.css({width:a,right:"0px"});setTimeout(function(){j.css({right:a}).fadeIn(200)},300)}else{var b=a+"px";h.css({left:"0px",width:b});setTimeout(function(){j.css({left:a}).fadeIn(200)},300)}}}};function getMousePos(b){var d=b||window.event;var f=document.documentElement.scrollLeft||document.body.scrollLeft;var c=document.documentElement.scrollTop||document.body.scrollTop;var a=d.pageX||d.clientX+f;var h=d.pageY||d.clientY+c;return{"x":a,"y":h}}var jbolt_tabbar=$("#jbolt_tabbar");var jbolt_tabs_container=$("#jbolt_tabs");var jbolt_tabs_array=[];var JBoltTabContextifyOptions={dividerClass:"divider",items:[{header:'<i class="fa fa-th mr-1"></i>可选操作'},{text:'<i class="fa fa-close mr-1"></i>关闭这个',onclick:function(a){JBoltTabUtil.closeJboltTab(a.data.key)}},{text:'<i class="fa fa-refresh mr-1"></i>刷新',onclick:function(a){JBoltTabUtil.showJboltTab(a.data.key,false,refreshPjaxContainer)}},{divider:true},{text:'<i class="fa fa-window-close-o mr-1"></i>关闭其它',onclick:function(a){JBoltTabUtil.closeOtherJboltTab(a.data.key)}},{text:'<i class="fa fa-toggle-left mr-1"></i>关闭左侧',onclick:function(a){JBoltTabUtil.closeAllLeftJboltTab(a.data.key)}},{text:'<i class="fa fa-toggle-right mr-1"></i>关闭右侧',onclick:function(a){JBoltTabUtil.closeAllRightJboltTab(a.data.key)}},{text:'<i class="fa fa-window-close mr-1"></i>关闭所有',onclick:function(a){JBoltTabUtil.closeAllJboltTab()}},]};var JBoltTabUtil={init:function(){var a=this;a.createJboltTabContextMenu();a.initAdminLeftNavTabsEvent();a.initTabsEvent();a.initTabsTriggerEvent()},initTabsTriggerEvent:function(){var a=this;jboltBody.on("click","[data-tabtrigger]",function(h){h.preventDefault();h.stopPropagation();var j=$(this);var c=j.attr("href");if(!c){c=j.data("url")}var f=j.attr("target");if(!f){f=j.data("target")}if(c&&c.indexOf("javascript")==-1){if(f&&f=="_self"){currentTabContentRedirectWithAjaxPortal(c)}else{var d=j.data("key");var i=j.data("title");if(!i){i=j.text()}var k=a.getCurrentTab();if(k){var b=k.data("key");a.addJboltTab(d,c,i,b)}else{a.addJboltTab(d,c,i)}}}})},initAdminLeftNavTabsEvent:function(){var a=this;jboltBody.on("click",".jbolt_admin_left_navs a:not([target])",function(d){d.preventDefault();d.stopPropagation();var h=$(this);var b=h.attr("href");if(b&&b.indexOf("javascript")==-1){var c=h.data("key");
var f=h.text().replace("├","");a.addJboltTab(c,b,f)}})},initTabsEvent:function(){var a=this;jboltBody.on("click","ul.jbolt_tabs>li",function(c){c.preventDefault();c.stopPropagation();var b=$(this).data("key");a.showJboltTab(b,true)}).on("click","ul.jbolt_tabs>li>i.close",function(c){c.preventDefault();c.stopPropagation();var b=$(this).parent().data("key");a.closeJboltTab(b)}).on("click","#jbolt_tabbar .jbolt_tab_left",function(b){b.preventDefault();b.stopPropagation();a.jboltTabToLeft()}).on("click","#jbolt_tabbar .jbolt_tab_right",function(b){b.preventDefault();b.stopPropagation();a.jboltTabToRight()}).on("click","#jboltTabContextMenu>a",function(d){d.preventDefault();d.stopPropagation();var c=$(this).data("func");var b=$(this).data("key");switch(c){case"close":JBoltTabUtil.closeJboltTab(b);break;case"closeAll":JBoltTabUtil.closeAllJboltTab();break;case"closeLeft":JBoltTabUtil.closeAllLeftJboltTab(b);break;case"closeRight":JBoltTabUtil.closeAllRightJboltTab(b);break;case"closeOther":JBoltTabUtil.closeOtherJboltTab(b);break;case"refresh":JBoltTabUtil.showJboltTab(b,false,refreshPjaxContainer);break}a.hideJboltContextMenu();return false}).on("dblclick","ul.jbolt_tabs>li",function(d){d.preventDefault();d.stopPropagation();var b=$(this).data("key");a.showJboltTab(b,true);var c=mainPjaxContainer.find(" div#tab_content_"+b);if(c&&c.length==1){LayerMsgBox.confirm("确认刷新此选项卡内容？",function(){c.ajaxPortal(true)})}}).on("contextmenu","ul.jbolt_tabs>li",function(b){b.preventDefault();b.stopPropagation();var c=getMousePos(b);a.showTabContextmenu($(this),c);return false}).on("click","#jboltTabContextMenu",function(b){b.preventDefault();b.stopPropagation();return false}).on("click",function(){a.hideJboltContextMenu()})},createJboltTabContextMenu:function(){var b=$("#jboltTabContextMenu");if(!b||b.length==0){var a='<div id="jboltTabContextMenu" class="dropdown-menu">'+'<span class="dropdown-item-text"><i class="fa fa-th mr-1"></i>可选操作</span>'+'<div class="dropdown-divider"></div>'+'<a class="dropdown-item" data-func="close" href="javascript:void(0)"><i class="fa fa-close mr-1"></i>关闭这个</a>'+'<a class="dropdown-item" data-func="refresh" href="javascript:void(0)"><i class="fa fa-refresh mr-1"></i>刷新</a>'+'<a class="dropdown-item" data-func="closeOther" href="javascript:void(0)"><i class="fa fa-window-close-o mr-1"></i>关闭其它</a>'+'<a class="dropdown-item" data-func="closeLeft" href="javascript:void(0)"><i class="fa fa-toggle-left mr-1"></i>关闭左侧</a>'+'<a class="dropdown-item" data-func="closeRight" href="javascript:void(0)"><i class="fa fa-toggle-right mr-1"></i>关闭右侧</a>'+'<a class="dropdown-item" data-func="closeAll" href="javascript:void(0)"><i class="fa fa-window-close mr-1"></i>关闭所有</a>'+"</div>";jboltBody.append(a)}},hideJboltContextMenu:function(){var a=$("#jboltTabContextMenu");if(a&&a.length==1){a.hide()}},showTabContextmenu:function(a,e){var c=$(a);var b=c.data("key");var d=$("#jboltTabContextMenu");if(!d||d.length==0){this.createJboltTabContextMenu()}d.data("key",b);d.find("a").data("key",b);d.css({top:e.y,left:e.x});d.show()},getCurrentTab:function(){var a=jbolt_tabs_container.find("li.active");if(a&&a.length==1){return a}return null},getCurrentTabContent:function(){var a=mainPjaxContainer.find("div.jbolt_tabcontent.active");if(a&&a.length==1){return a}return null},isJboltTabExist:function(b){var a=jbolt_tabs_container.find("li[data-key='"+b+"']");return a&&a.length==1},addJboltTabWithoutContentUrl:function(){var k=this;var j=mainPjaxContainer.find(".jbolt_page[data-key]");if(j&&j.length==1){var b=j.data("key");var a=$(".jbolt_admin_left_navs a[href='"+b+"']");if(a&&a.length==1){var m=a.data("key");var o=$.trim(a.text().replace("├",""));k.addJboltTabWithoutContent(m,b,o)}else{var o=j.data("text");if(o){k.addJboltTabWithoutContent(m,b,o)}else{var e=j.data("dontchangeleftnav");if(e){var h=$(".jbolt_admin_left_navs a[href]");if(isOk(h)){var n,f,c,d,i;h.each(function(){n=$(this);f=n.attr("href");c=$.trim(n.text().replace("├",""));if(b.indexOf(f)!=-1){if((!d||!i)||f.length>d){i=c;d=f.length}}});if(!i){var l=j.find(".jbolt_page_title h1");if(isOk(l)){i=l.text()}if(!i){i=" "}}k.addJboltTabWithoutContent(m,b,i)}}}}}},addJboltTabWithoutContent:function(b,a,f){var e=this;var c=e.isJboltTabExist(b);if(!c){jbolt_tabs_container.append('<li id="tab_'+b+'" data-key="'+b+'" data-url="'+a+'"><span>'+f+'</span><i class="close">&times;</i></li>');var d=mainPjaxContainer.find("div.jbolt_tabcontent");if(d&&d.length==1){d.data("key",b);d.data("url",a);d.attr("id","tab_content_"+b)}}e.showJboltTab(b)},initTabContextMenuEvent:function(){$("#tab_"+key).tabContextMenu(JBoltTabContextifyOptions)},addJboltTab:function(c,b,f,a){var e=this;var d=e.isJboltTabExist(c);if(d){e.showJboltTab(c,true)}else{a=a?a:"";jbolt_tabs_container.append('<li id="tab_'+c+'" data-key="'+c+'" data-trigger-tab-key="'+a+'" data-url="'+b+'"><span>'+f+'</span><i class="close">&times;</i></li>');mainPjaxContainer.append('<div class="jbolt_tabcontent" id="tab_content_'+c+'" data-trigger-tab-key="'+a+'" data-ajaxportal data-key="'+c+'" data-url="'+b+'"></div>');
mainPjaxContainer.find("div#tab_content_"+c).ajaxPortal(true);e.showJboltTab(c);e.jboltTabToRight()}},hideAllJboltTab:function(){jbolt_tabs_container.find("li.active").removeClass("active");mainPjaxContainer.find("div.jbolt_tabcontent.active").removeClass("active")},changeUrlByContentPortal:function(){var c=this.getCurrentTab();var b=this.getCurrentTabContent();var a=b.data("url");c.data("url",a)},changeUrl:function(a){var c=this.getCurrentTab();var b=this.getCurrentTabContent();if(c&&c.length==1){c.data("url",a);b.data("url",a);c.attr("data-url",a);b.attr("data-url",a)}},showJboltTab:function(d,c,f){var e=this;var a=jbolt_tabs_container.find("li#tab_"+d);if(a&&a.length==1){var b=a.hasClass("active");if(!b){e.hideAllJboltTab();a.addClass("active");mainPjaxContainer.find("div#tab_content_"+d).addClass("active");openLeftNav(a.data("url"))}if(c){e.changeTabLocation()}if(f){f()}}},showFirstLeftNavTab:function(){var c=this;var e=$(".jbolt_admin_left_navs a[data-hasurl]").first();if(e&&e.length==1){var a=e.attr("href");if(a&&a.indexOf("javascript")==-1){var b=e.data("key");var d=e.text().replace("├","");c.addJboltTab(b,a,d)}}},openTabByNav:function(d){var a=d.attr("href");if(a&&a.indexOf("javascript")==-1){var b=d.data("key");var c=d.text().replace("├","");this.addJboltTab(b,a,c)}},getTabCount:function(){var a=jbolt_tabs_container.find("li");if(a&&a.length>0){return a.length}return 0},close:function(a){this.closeJboltTab(a.data("key"))},closeJboltTab:function(b){var d=this;var a=jbolt_tabs_container.find("li#tab_"+b);if(a&&a.length==1){var e=a.hasClass("active");if(e){d.changeToBrotherTab(a)}a.remove();mainPjaxContainer.find("div#tab_content_"+b).remove();var c=d.getTabCount();if(c==0){d.showFirstLeftNavTab()}if(!e){d.changeTabLocation()}}},closeOtherJboltTab:function(b){var c=this;c.showJboltTab(b);var a=jbolt_tabs_container.find("li:not("+"#tab_"+b+")");if(a&&a.length>0){a.each(function(){var d=$(this);var e=d.data("key");d.remove();mainPjaxContainer.find("div#tab_content_"+e).remove()})}},closeAllJboltTab:function(){jbolt_tabs_container.empty();mainPjaxContainer.empty();this.showFirstLeftNavTab()},closeAllLeftJboltTab:function(d){var e=this;var a=jbolt_tabs_container.find("li#tab_"+d);var c=a.prevAll("li");var f=a.hasClass("active");var b=false;if(c&&c.length>0){c.each(function(){var h=$(this);var i=h.data("key");if(h.hasClass("active")){b=true}h.remove();mainPjaxContainer.find("div#tab_content_"+i).remove()})}if(!f&&b){e.showJboltTab(d)}},closeAllRightJboltTab:function(d){var e=this;var a=jbolt_tabs_container.find("li#tab_"+d);var c=a.nextAll("li");var f=a.hasClass("active");var b=false;if(c&&c.length>0){c.each(function(){var h=$(this);var i=h.data("key");if(h.hasClass("active")){b=true}h.remove();mainPjaxContainer.find("div#tab_content_"+i).remove()})}if(!f&&b){e.showJboltTab(d)}},changeToBrotherTab:function(a){var e=this;var b=a.prev();var d=b&&b.length==1;if(!d){b=a.next();d=b&&b.length==1}if(d){var c=b.data("key");e.showJboltTab(c)}else{e.showFirstLeftNavTab()}},checkCanToLeft:function(){var b=jbolt_tabbar.width();var a=jbolt_tabs_container.outerWidth();if(a>b){var d=Math.abs(parseInt(jbolt_tabs_container.css("margin-left")));var c=Math.abs(parseInt(b-a));if(d<c){return true}}return false},checkCanToRight:function(){var a=Math.abs(parseInt(jbolt_tabs_container.css("margin-left")));return a!=0},jboltTabToLeft:function(){jbolt_tabs_container.css("margin-left","0px")},jboltTabToRight:function(){var f=jbolt_tabbar.width();var d=jbolt_tabs_container.outerWidth();if(d>f){var b=(f/2)-d;var e=null;var a=0;var c=Math.abs(b);jbolt_tabs_container.find("li").each(function(){b=a*-1;a=a+$(this).outerWidth();if(a>=c){return false}});jbolt_tabs_container.css("margin-left",b+"px")}},changeTabLocation:function(){var e=this;var h=jbolt_tabbar.width();var d=jbolt_tabs_container.outerWidth();if(d>h){var b=e.getCurrentTab();var j=Math.abs(parseInt(jbolt_tabs_container.css("margin-left")));var f=0;var c=0;jbolt_tabs_container.find("li").each(function(){var k=$(this);c=c+k.outerWidth();if(k.data("key")==b.data("key")){return false}else{f=f+k.outerWidth()}});if(j==0){if(f<=h){}else{var i=f*-1;jbolt_tabs_container.css("margin-left",i+"px")}}else{if(c<=h){e.jboltTabToLeft()}else{var a=(h/2)-d;var i=f*-1;if(f>Math.abs(parseInt(a))){e.jboltTabToRight()}else{jbolt_tabs_container.css("margin-left",i+"px")}}}}else{e.jboltTabToLeft()}}};(function(a){a.fn.extend({toJsonObject:function(){var c={};var b=this.serializeArray();a.each(b,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(this.value||"")}else{c[this.name]=this.value||""}});return c}})})(jQuery);(function(a){a.fn.extend({toggleContent:function(c){var b=this.html();if(b&&b>0){this.html("")}else{this.html(c)}}})})(jQuery);function randomId(){var a=Math.random();a=a.toString().replace(".","");return new Date().getTime()+a}var SwitchBtnUtil={initBtn:function(b){var c=this;var e=b.attr("src");if(!e){var d=b.data("value");if(!d||d=="null"||d=="undefined"){d=false
}else{d=true}var a=b.data("style");if(!a){a="default"}var e="/assets/img/switch/"+a+"/"+(d?"on":"off")+".png";b.attr("src",e)}b.off("click").on("click",function(j){j.preventDefault();j.stopPropagation();var i=b.data("doing");if(i){return false}i=true;b.data("doing",true);var h=b.data("url");var f=b.data("confirm");if(h){if(f){LayerMsgBox.confirm(f,function(){c.switchIt(b)},function(){b.data("doing",false)})}else{c.switchIt(b)}}else{c.switchSuccessHandler(b)}})},initBtns:function(d){if(!isOk(d)){return false}var c=this;var a=d.length;for(var b=0;b<a;b++){c.initBtn(d.eq(b))}},init:function(d){var c=this;var a=getRealJqueryObject(d);if(!isOk(a)){return false}var b=a.find("img[data-switchbtn]");if(!isOk(b)){return false}c.initBtns(b)},switchIt:function(b){var c=this;var a=b.data("url");LayerMsgBox.loading("正在执行...",10000);$.ajax({type:"post",url:a,timeout:10000,dataType:"json",success:function(d){if(d.state=="ok"){c.switchSuccessHandler(b)}else{b.data("doing",false);LayerMsgBox.alert(d.msg,2)}},error:function(){b.data("doing",false);LayerMsgBox.alert("操作失败",2)}})},switchSuccessHandler:function(_btn){var src=_btn.attr("src");var handler=_btn.data("handler");var on=src.indexOf("off")!=-1;if(src.indexOf("off")!=-1){src=src.replace("off","on")}else{src=src.replace("on","off")}_btn.attr("src",src);LayerMsgBox.closeLoadingNow();if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){LayerMsgBox.success("操作成功",300,function(){exe_handler(_btn,on);_btn.data("doing",false)})}else{LayerMsgBox.success("操作成功",300,function(){_btn.data("doing",false)})}}else{LayerMsgBox.success("操作成功",300,function(){_btn.data("doing",false)})}}};function processHiddenInput(a,c){var b=getCheckedIds(a);$("#"+c).val(b)}var CheckboxUtil={initCheckBoxEvent:function(ck,name,hiddenInputId,handler){if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){ck.find("input[type='checkbox'][name='"+name+"']").unbind("change").on("change",function(){if(handler=="processHiddenInput"){processHiddenInput(name,hiddenInputId)}else{var input=$(this);exe_handler(input,input.is(":checked"))}})}}},initCheckboxs:function(b){if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){this.initCheckbox(b.eq(c))}},initCheckbox:function(i){var d=this,j=i.data("handler"),a=i.data("name"),h=i.data("value")+"",e=i.data("default")+"",c=i.data("hiddeninput"),b=i.data("url"),f=i.data("label");if(!h){h=""}else{h=h+""}if(!e){e=""}else{e=e+""}if(b){d.insertDatas(i,b,a,f,function(){d.initCheckBoxEvent(i,a,c,j);d.setChecked(a,h,e)})}else{d.initCheckBoxEvent(i,a,c,j);d.setChecked(a,h,e)}},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-checkbox]");if(!isOk(a)){return false}this.initCheckboxs(a)},insertDatas:function(p,b,c,n,o){var i=this;p.empty();var d=p.data("width");var l="";var k="";if(d){var h=d.split(",");l=h[0];k=h[1]}else{l="100px";k="col"}var f="";if(n){if(l.indexOf("px")!=-1){f='<label class="col-auto col-form-label" style="width:'+l+'">'+n+"</label>"}else{f='<label class="'+l+' col-form-label">'+n+"</label>"}}var j="";var e=p.data("inline");if(e){j="checkbox-inline"}var a=p.data("text-attr");if(!a){a="text"}var m=p.data("value-attr");if(!m){m="value"}Ajax.get(b,function(r){f+='<div class="'+k+'"  style="padding-top: 1px;">';var v=r.data;var w=c.replace("\\.","_");if(v&&v.length>0){var u,x,t;for(var q in v){u=v[q];x=processOptionText(u,a);t=processOptionValue(u,m);w=w+"_"+q;var s='<div class="checkbox checkbox-primary '+j+'">'+'<input  id="'+w+'" type="checkbox" name="'+c+'" value="'+t+'"/>'+'<label for="'+w+'">'+x+"</label>"+"</div>";f+=s}f+="</div>";p.html(f);if(o){o()}}})},checkByArray:function(d,c){c=c.toString();if(c.indexOf(",")!=-1){var a=c.split(",");if(a&&a.length>0){for(var e in a){var b=$("input[type='checkbox'][name='"+d+"'][value='"+a[e]+"']");b.attr("checked","checked")}}}else{var b=$("input[type='checkbox'][name='"+d+"'][value='"+c+"']");b.attr("checked","checked")}},setChecked:function(b,d,a){var c=this;if(d){c.checkByArray(b,d)}else{if(a||a==0||a=="0"){c.checkByArray(b,a)}}}};var HtmlEditorUtil={ing:false,initEditors:function(d){if(!isOk(d)){return false}var c=this,a=d.lenght;for(var b=0;b<a;b++){c.initEditor(d.eq(b))}},init:function(c){var a=getRealJqueryObject(c);if(!isOk(a)){return false}var b=jboltBody.find("[data-editor]");if(!isOk(b)){return false}this.ing=false;this.initEditor(b)},initNEditor:function(i){var j=this;var c=i.attr("id");if(!c){alert("请设置编辑器的id属性");return false}var e=$("script[src*='neditor']");if(!e||e.length==0){LayerMsgBox.alert("未引入NEditor的js");return false}var b=i.data("imgmaxsize");if(!b){b=200}b=b*1024;var d=i.data("videomaxsize");if(!d){d=10}d=d*1024*1024*1024;var o={imageMaxSize:b,videoMaxSize:d,wordCount:false,elementPathEnabled:false,toolbars:[["source","undo","redo","bold","italic","underline","strikethrough","fontborder","indent","superscript","subscript","justifyleft","justifyright","justifycenter","justifyjustify","forecolor","backcolor","removeformat","formatmatch","autotypeset","touppercase","tolowercase","fontfamily","fontsize","paragraph","customstyle","searchreplace","blockquote","pasteplain","selectall","cleardoc","link","unlink","emotion","spechars","insertorderedlist","insertunorderedlist","horizontal","date","time","insertimage","wordimage","imagenone","imageleft","imageright","imagecenter","lineheight","map","insertvideo","insertcode","inserttable","edittable","edittd","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","deletecaption","inserttitle","mergecells","deletetable","insertparagraphbeforetable","directionalityltr","directionalityrtl","rowspacingtop","rowspacingbottom","background","template","scrawl","drafts","print","preview","help","fullscreen",]],allowDivTransToP:false};
var a=i.data("width");var m=i.data("height");if(!a){a="100%"}if(!m){m=300}o["initialFrameWidth"]=a;o["initialFrameHeight"]=m;var f=i.data("urlprefix");if(f){o["imageUrlPrefix"]=f;o["scrawlUrlPrefix"]=f;o["videoUrlPrefix"]=f;o["fileUrlPrefix"]=f}else{var n=i.data("imageurlprefix");if(n){o["imageUrlPrefix"]=imageurlprefix}var h=i.data("scrawlurlprefix");if(h){o["scrawlUrlPrefix"]=h}var k=i.data("videourlprefix");if(k){o["videoUrlPrefix"]=k}var l=i.data("fileurlprefix");if(l){o["fileUrlPrefix"]=l}}j.processInitNEditor(i,o)},processInitNEditor:function(f,a){var c=this;var b=f.attr("id");if(!b){alert("请设置编辑器的id属性");return false}var e=f.data("hiddeninput");UE.delEditor(b);var d=UE.getEditor(b,a);d.addListener("contentChange",function(){if(e){var i=$("#"+b).closest(".jbolt_page").find("#"+e);if(i&&i.length>0){var h=d.getContent();i.val(h)}}})},initSummernoteEditor:function(h){var f=this;var e=h.attr("id");if(!e){alert("请设置编辑器的id属性");return false}var d=h.data("width");var a=h.data("height");var b=h.data("maxsize");if(!b){b=200}var i=h.data("placeholder");var c={lang:"zh-CN",toolbar:[["style",["style"]],["font",["bold","italic","underline","clear","strikethrough","superscript","subscript"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph","height"]],["insert",["hr","table","link","picture","video"]],["misc",["fullscreen","codeview","undo","redo","help"]]],callbacks:{onImageUpload:function(n,m,k){if(f.ing){alert("有文件正在上传，请稍后~~")}else{f.ing=true;var j=n.length;for(var l=0;l<j;l++){if(n[l].size/1024>b){f.ing=false;LayerMsgBox.alert("图片文件不能大于"+b+"k",2);return false}f.sendSummernoteFile(h,n[l])}f.ing=false}},onChange:function(k,j){var m=h.data("hiddeninput");if(m){var l=$("#"+m);if(l&&l.length>0){l.val(k)}}},onPaste:function(j){if(f.ing){alert("有文件正在上传，请稍后~~")}else{f.parseIamge(j,h)}}}};if(i){c.placeholder=i}if(d){c.width=d+"px"}if(!a){a=300}c.height=a+"px";h.summernote(c)},initEditor:function(d){var c=this;var b=d.attr("id");if(!b){alert("请设置编辑器的id属性");return false}var a=d.data("editor");if(a=="summernote"){c.initSummernoteEditor(d)}else{if(a=="neditor"){c.initNEditor(d)}else{LayerMsgBox.alert("data-editor类型错误",2)}}},parseIamge:function(k,f){var j=this;j.ing=true;var a=f.data("maxsize");if(!a){a=200}var d=k.originalEvent;var h=d.clipboardData.files;if(!h||h.length==0){j.ing=false;return false}d.stopPropagation();d.preventDefault();for(var c in h){var b=h[c];if(j.ing==false||!(b.type.match(/^image/))){return false}if(b.size/1024>a){j.ing=false;LayerMsgBox.alert("剪贴板中图片文件不能大于"+a+"k",2);return false}j.sendSummernoteFile(f,b)}},sendSummernoteFile:function(e,d){var f=this;f.ing=true;var b=e.data("imguploadurl");if(!b){b=summernote_img_uploadurl}var a=e.data("fileinputname");if(!a){a="file"}var h=e.data("imghost");var c=new FormData();c.append(a,d);$.ajax({type:"post",url:b,data:c,timeout:60000,cache:false,async:true,processData:false,contentType:false,success:function(i){if(i.state=="ok"){if(i.data){e.summernote("insertImage",(h?(h+"/"):"/")+i.data);LayerMsgBox.success("上传成功",1000)}else{LayerMsgBox.success("上传异常",1000)}}else{LayerMsgBox.error(i.msg,1000)}f.ing=false},error:function(i){f.ing=false;LayerMsgBox.error("网络异常",1000)}})}};var RadioUtil={initRadioEvent:function(r,name,handler){if(handler){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){r.find("input[type='radio'][name='"+name+"']").unbind("click").on("click",function(e){var r=$(this);var val=r.val();exe_handler(r,val)})}}},initRadios:function(c){if(!isOk(c)){return false}var a=c.length;for(var b=0;b<a;b++){this.initRadio(c.eq(b))}},initRadio:function(h){var f=this,i=h.data("value")+"",a=h.data("default")+"",d=h.data("name"),e=h.data("handler"),c=h.data("url"),b=h.data("label");if(!i){i=""}else{i=i+""}if(!a){a=""}else{a=a+""}if(c){f.insertDatas(h,c,d,b,function(){f.initRadioEvent(h,d,e);f.setChecked(d,i,a)})}else{f.initRadioEvent(h,d,e);f.setChecked(d,i,a)}},init:function(b){var a=getRealJqueryObject(b);if(!isOk(a)){return false}var c=a.find("[data-radio]");if(!isOk(c)){return false}this.initRadios(c)},insertDatas:function(a,c,d,o,p){var j=this;a.empty();var e=a.data("width");var m="";var l="";if(e){var i=e.split(",");m=i[0];l=i[1]}else{m="100px";l="col"}var h="";if(o){if(m.indexOf("px")!=-1){h='<label class="col-auto col-form-label" style="width:'+m+'">'+o+"</label>"}else{h='<label class="'+m+' col-form-label">'+o+"</label>"}}var k="";var f=a.data("inline");if(f){k="radio-inline"}var b=a.data("text-attr");if(!b){b="text"}var n=a.data("value-attr");if(!n){n="value"}Ajax.get(c,function(r){h+='<div class="'+l+'"  style="padding-top: 1px;">';var v=r.data;var w=d.replace("\\.","_");if(v&&v.length>0){var u,x,t;for(var q in v){u=v[q];x=processOptionText(u,b);t=processOptionValue(u,n);w=w+"_"+q;var s='<div class="radio radio-primary '+k+'">'+'<input  id="'+w+'" type="radio" name="'+d+'" value="'+t+'"/>'+'<label for="'+w+'">'+x+"</label>"+"</div>";h+=s}h+="</div>";a.html(h);if(p){p()}}})},setChecked:function(b,c,a){if(c&&c.length>0){$("input[type='radio'][name='"+b+"'][value='"+c+"']").click()
}else{if(a){if(a=="all"){$("input[type='radio'][name='"+b+"'][data-all]").click()}else{if(a=="options_first"){$("input[type='radio'][name='"+b+"']:first").click()}else{if(a=="options_last"){$("input[type='radio'][name='"+b+"']:last").click()}else{$("input[type='radio'][name='"+b+"'][value='"+a+"']").click()}}}}}}};var LayerTipsUtil={initTip:function(c){var a=c.data("trigger");if(a&&a=="click"){var b=0;c.off("click").on("click",function(f){f.stopPropagation();f.preventDefault();var d=$(this).data("content");b=layer.tips(d,this,{tips:[4,"#3595CC"],time:10000});$("#layui-layer"+b).on("click",function(h){h.stopPropagation();h.preventDefault()});jboltBody.on("click",function(){layer.close(b)})})}else{var b=0;c.off("mouseover").on("mouseover",function(){var d=$(this).data("content");b=layer.tips(d,this,{tips:[4,"#3595CC"],time:4000})}).off("mouseout").on("mouseout",function(){layer.close(b)})}},initTips:function(b){if(!isOk(b)){return false}var d=this;var a=b.length;for(var c=0;c<a;c++){d.initTip(b.eq(c))}},init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-tipsbtn]");if(!isOk(a)){return false}this.initTips(a)}};var LayerPhotoUtil={init:function(){var a=this;jboltBody.on("click","[data-photobtn]",function(j){j.preventDefault();j.stopPropagation();var h=$(this);var f=null;var i=h.data("target");if(this.tagName.toLowerCase()=="a"){f=h.attr("href")}else{if(this.tagName.toLowerCase()=="img"){f=h.attr("src")}}if(!f){f=h.data("url")}if(f){var b=null;var c=h.data("ablum");if(c){b=a.getablum(c,f);if(!b){b=[{"src":f,}]}}else{b=[{"src":f,}]}var d={photos:{"title":"JBolt图片查看器","start":0,"data":b},anim:5};if(i&&i=="parent"){layer.photos(d)}else{layer.photos(d)}}else{alert("页面存在未设置图片地址的 photobtn")}})},getablum:function(b,d){var c=jboltBody.find("[data-photobtn][data-ablum='"+b+"']");if(!isOk(c)){return null}var a=new Array();a.push({src:d});c.each(function(){var f=$(this);var e=null;if(this.tagName.toLowerCase()=="a"){e=f.attr("href")}else{if(this.tagName.toLowerCase()=="img"){e=f.attr("src")}}if(!e){e=f.data("url")}if(e!=d){a.push({src:e})}});return a}};(function(a){a.extend(a.fn,{ajaxPortal:function(c,b,d,e){return this.each(function(){var f=a(this);var h="";if(b){h=b}else{h=f.data("url")}if(h.indexOf("?")!=-1){h=h+"&t="+new Date().getTime()}else{h=h+"?t="+new Date().getTime()}var i=f.data("autoload");if(i==undefined){i=true}if((c==undefined&&i)||(c!=undefined)){a.ajax({type:"GET",url:h,beforeSend:function(j){j.setRequestHeader("AJAX-PORTAL","true")},dataType:"html",success:function(k){if(c){f.empty().html(k)}else{f.append(k)}if(d&&b){f.data("url",b)}var j=f.attr("id");if(!j){j=randomId();f.attr("id",j)}afterAjaxPortal(f);if(e){e()}}})}})}})})(jQuery);function afterAjaxPortal(a){$(".tooltip.show").remove();SelectUtil.initAutoSetValue(a);JAtomFileUploadUtil.init(a);JAtomImgUploader.init(a);SwitchBtnUtil.init(a);FormDate.init(a);LayerTipsUtil.init(a);HtmlEditorUtil.init(a);ImageViewerUtil.init(a);RadioUtil.init(a);CheckboxUtil.init(a);AutocompleteUtil.init(a);Select2Util.init(a);SelectUtil.init({parent:a});MasterSlaveUtil.init(a);initToolTip(a);MultipleFileInputUtil.init(a);initAjaxPortal(a)}function validateFileMaxSize(d,e){var b=(d.files[0].size/1024).toFixed(1);var c=(b>e);var a=b+"KB";if(b>1024){a=((b/1024).toFixed(1))+"M"}if(c){LayerMsgBox.alert("您选择的文件["+a+"],上传限制不能超过 "+e+"KB",2)}return c}function validateExcel(a,c){var b=a.value;if(!/.(xls|xlsx)$/.test(b)){LayerMsgBox.alert("文件类型必须是xls,xlsx中的一种",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateNormal(a,c){var b=a.value;if(!/.(xls|xlsx|jpg|jpeg|png|JPG|rar|zip|pdf|mp4|flv|mp3|doc|docx)$/.test(b)){LayerMsgBox.alert("此文件类型不允许上传",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function isImg(a){return/.(jpg|jpeg|png|JPG)$/.test(a)}function validateImg(a,c){var b=a.value;if(isImg(b)==false){LayerMsgBox.alert("图片类型必须是jpeg,jpg,png中的一种",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateFile(b,a,e){var d=b[0];if(!e){e=1024*1024*1024*2}var c=true;if(a){switch(a){case"img":c=validateImg(d,e);break;case"excel":c=validateExcel(d,e);break;case"file":c=validateNormal(d,e);break}}else{c=validateNormal(d,e)}return c}function getObjectURL(c){var b=c.files[0];var a=null;if(window.createObjectURL!=undefined){a=window.createObjectURL(b)}else{if(window.URL!=undefined){a=window.URL.createObjectURL(b)}else{if(window.webkitURL!=undefined){a=window.webkitURL.createObjectURL(b)}}}return a}var JAtomImgUploader={tpl:'<input type="file"   {@if rule}data-rule="${rule}"{@/if}  {@if tips}data-tips="${tips}"{@/if} ><p class="j_img_uploder_msg"><span class="j_file_name"></span><i class="fa fa-remove j_text_danger j_remove_file"></i></p>',init:function(f){var e=this;var d=getRealJqueryObject(f);if(!isOk(d)){return false}var b=d.find(".j_img_uploder");if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){JAtomImgUploader.initSingle(b.eq(c))}},initSingle:function(f){var e=this;
var i=f.data("rule");var b=f.data("tips");var d=f.data("area");if(d){var a=d.split(",");f.css({"width":a[0],"height":a[1]})}f.html(juicer(e.tpl,{rule:i,tips:b}));var h=f.data("value");if(h&&h!="/assets/img/uploadimg.png"){var c="#999 url("+h+") center center no-repeat";f.css({"background":c,"background-size":"100%"});f.find("p.j_img_uploder_msg").show()}f.find("input[type='file']").on("change",function(l){var j=$(this);var k=l.target.files;e.changeFile(j)});f.find(".j_remove_file").on("click",function(){var j=$(this);e.removeFile(j)})},removeFile:function(removeBtn){var uploder=removeBtn.closest(".j_img_uploder");var removehandler=uploder.data("removehandler");uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});var hiddeninput=uploder.data("hiddeninput");if(hiddeninput){$("#"+hiddeninput).val("")}if(removehandler){var exe=eval(removehandler);if(exe){exe(uploder)}}},changeFile:function(file){var uploder=file.closest(".j_img_uploder");var maxSize=uploder.data("maxsize");var fileValue=file.val();var hiddeninput=uploder.data("hiddeninput");var handler=uploder.data("handler");if(hiddeninput&&handler&&handler!="uploadMultipleFile"){$("#"+hiddeninput).val("")}if(fileValue){if(validateFile(file,"img",maxSize)){var arr=fileValue.split("\\");var fileName=arr[arr.length-1];if(handler&&handler!="uploadMultipleFile"){uploder.find("span.j_file_name").text(fileName).attr("title",fileName);uploder.find("p.j_img_uploder_msg").show();var fileData=getObjectURL(file[0]);if(fileData){uploder.css({"background":"#999 url('"+fileData+"') center center no-repeat","background-size":"100%"})}}uploder.closest(".form-group").removeClass("has-error")}else{file.val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});return false}}else{uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"})}if(handler){var isMultiple=(handler=="uploadMultipleFile");if(handler=="uploadFile"||isMultiple){var url=uploder.data("url");if(!url){LayerMsgBox.alert("未设置文件上传地址 data-url",2)}else{LayerMsgBox.loading("处理中",1000);var hiddeninput=uploder.data("hiddeninput");var imgbox=uploder.data("imgbox");var limit=uploder.data("limit");var imgs=$("#"+imgbox+" img");if(imgs&&imgs.length>=limit){LayerMsgBox.alert("最多上传["+limit+"]张",5);uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});return false}var fileName=uploder.data("filename");if(!fileName){fileName="file"}uploadFile("img",url,fileName,file[0].files[0],hiddeninput,null,null,isMultiple,imgbox,function(){if(isMultiple){uploder.find("input[type='file']").val("")}})}}else{var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(file.val(),file)}}}}};function processImagesHiddenInputValue(h,f){var a=$("#"+h);var b=$("#"+f);var e="";var i=a.find("img");var c=i.length;var d=c-1;if(c>0){i.each(function(k,l){var j=$(this);e=e+j.attr("src");if(k<d){e=e+","}})}b.val(e)}function removeUploadImgBoxLi(d){var b=$(d);var a=b.closest("li");var c=a.data("hiddeninput");var e=a.data("imgbox");a.remove();processImagesHiddenInputValue(e,c)}function imgGotoLeft(c){var f=$(c);var a=f.closest("li");var d=a.prev();if(d){var b=a.clone();d.before(b);var e=a.data("hiddeninput");var h=a.data("imgbox");a.remove();processImagesHiddenInputValue(h,e)}else{layer.msg("已经是第一个",{time:1000})}}function imgGotoRight(c){var f=$(c);var a=f.closest("li");var d=a.next();if(d){var b=a.clone();d.after(b);var e=a.data("hiddeninput");var h=a.data("imgbox");a.remove();processImagesHiddenInputValue(h,e)}else{layer.msg("已经是最后一个",{time:1000})}}function uploadFile(k,a,b,e,j,d,m,i,h,l){LayerMsgBox.loading("上传中",10000);var f=parseInt((e.size/1024).toFixed(0));var c=new FormData();c.append(b,e);$.ajax({type:"POST",url:a,data:c,timeout:60000,cache:false,async:true,processData:false,contentType:false,success:function(q){if(q.state=="ok"){if(m){$("#"+m).val(f)}if((k=="img")&&j&&q.data){var n=q.data;var r=$("#"+j);var p=$.trim(r.val());if(i&&h){$("#"+h).append("<li data-imgbox='"+h+"' data-hiddeninput='"+j+"'><img src='"+n+"'/><div class='optbox' ><i title='删除' onclick='removeUploadImgBoxLi(this)' class='fa fa-trash'></i><i onclick='imgGotoLeft(this)' class='fa fa-arrow-left' title='左移'></i><i title='右移' onclick='imgGotoRight(this)' class='fa fa-arrow-right'></i></div></li>");if(!p){p=n}else{p=p+","+n}}else{p=n}r.val(p)}else{if((k=="file")&&j&&q.data){$("#"+j).val(q.data.fileUrl);
if(d){var o=$("#"+d).val();if((o&&o.length>2)==false){$("#"+d).val(q.data.fileName)}}}}if(l){l()}LayerMsgBox.success("上传成功",1000)}else{LayerMsgBox.error(q.msg,1000)}},error:function(n){LayerMsgBox.error("网络异常",1000)}})}function getBase64Image(b){var c=document.createElement("canvas");c.width=b.width;c.height=b.height;var a=c.getContext("2d");a.drawImage(b,0,0,b.width,b.height);var d=c.toDataURL("image/png");return d}function dataURItoBlob(b){var f=atob(b.split(",")[1]);var a=b.split(",")[0].split(":")[1].split(";")[0];var e=new ArrayBuffer(f.length);var c=new Uint8Array(e);for(var d=0;d<f.length;d++){c[d]=f.charCodeAt(d)}return new Blob([e],{type:a})}var JAtomFileUploadUtil={tpl:'<div class="j_upload_file"><input type="file"  {@if rule}data-rule="${rule}"{@/if} {@if tips}data-tips="${tips}"{@/if}  /></div><p class="j_upload_file_box_msg"><span class="j_file_name"></span><i class="fa fa-remove j_text_danger j_remove_file"></i></p>',initFileBoxUI:function(f){if(!isOk(f)){return false}var b=f.length;var d,e,a;for(var c=0;c<b;c++){d=f.eq(c);e=d.data("rule");a=d.data("tips");d.html(juicer(this.tpl,{rule:e,tips:a}))}},initFileBoxEvent:function(fileBoxs){if(!isOk(fileBoxs)){return false}var that=this;fileBoxs.find("input[type='file']").on("change",function(){var file=$(this);var box=file.closest(".j_upload_file_box");var accept=box.data("accept");var maxSize=box.data("maxsize");var fileValue=file.val();if(fileValue){if(validateFile(file,accept,maxSize)){var arr=fileValue.split("\\");var fileName=arr[arr.length-1];box.find("span.j_file_name").text(fileName);box.find("p.j_upload_file_box_msg").show();box.find(".j_upload_file").addClass("j_reupload");box.closest(".form-group").removeClass("has-error");var imgpreview=box.data("imgpreview");if(imgpreview){if(isImg(fileName)){var imgpreviewBox=$(imgpreview);if(imgpreviewBox&&imgpreviewBox.length){var url=getObjectURL(file[0]);if(url){imgpreviewBox.html("<img src='"+url+"'/>")}}}}}else{that.clearIt(box);return false}}else{that.clearIt(box)}var handler=box.data("handler");if(handler){if(handler=="uploadFile"){var url=box.data("url");if(!url){LayerMsgBox.alert("未设置文件上传地址 data-url",2)}else{var hiddeninput=box.data("hiddeninput");var sizeinput=box.data("sizeinput");var fileNameInput=box.data("filenameinput");var fileName=box.data("filename");if(!fileName){fileName="file"}uploadFile("file",url,fileName,file[0].files[0],hiddeninput,fileNameInput,sizeinput)}}else{var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(file.val(),file)}}}});fileBoxs.find(".j_remove_file").on("click",function(){var removefile=$(this);var box=removefile.closest(".j_upload_file_box");that.clearIt(box)})},init:function(c){var b=this;var a=getRealJqueryObject(c);if(!isOk(a)){return false}var d=a.find(".j_upload_file_box");if(isOk(d)){b.initFileBoxUI(d);b.initFileBoxEvent(d)}},clearIt:function(b){b.find("input[type='file']").val("");b.find("span.j_file_name").text("");b.find("p.j_upload_file_box_msg").hide();b.find(".j_upload_file").removeClass("j_reupload");var a=b.data("imgpreview");if(a){$(a).empty()}}};var LayerMsgBox={alert:function(c,b,a){if(b){layer.alert(c,{icon:b},function(d){if(a){a()}layer.close(d)})}else{layer.alert(c,function(d){if(a){a()}layer.close(d)})}},confirm:function(c,a,b){layer.confirm(c,{icon:3,title:"请选择"},function(d){if(a){a()}layer.close(d)},function(d){if(b){b()}layer.close(d)})},success:function(d,c,b){if(!d){d="操作成功"}if(!c){c=1000}var a=layer.msg(d,{time:c,icon:1},function(){if(b){b()}});return a},error:function(d,c,b){if(!d){d="错误"}if(!c){c=1500}var a=layer.msg(d,{time:c,icon:2},function(){if(b){b()}});return a},prompt:function(d,e,c,b){if(b==undefined){b=2}var a=layer.prompt({title:d,value:(e?e:""),formType:b},function(h,f){if(c){c(f,h)}});return a},loading:function(d,c,b){if(!d){d="执行中..."}var a=null;c=(c?c:10000);if(c){a=layer.msg(d,{time:c,icon:16,shade:0.3},function(){if(b){b()}})}else{a=layer.msg(d,{icon:16})}return a},close:function(a){layer.close(a)},closeAll:function(a){if(a){layer.closeAll(a)}else{layer.closeAll()}},closeLoading:function(){setTimeout(function(){layer.closeAll("dialog")},500)},closeLoadingNow:function(){layer.closeAll("dialog")},load:function(b,c){var a=null;if(c){a=layer.load(b,{time:c})}else{a=layer.load(b)}return a},closeLoad:function(){setTimeout(function(){layer.closeAll("loading")},200)},closeLoadNow:function(){layer.closeAll("loading")}};var jboltAjaxTimeout=60000;var Ajax={uploadBase64File:function(d,b,h,f,c,e){var a=dataURItoBlob(b);this.uploadBlob(d,a,h,f,c,e)},uploadBlob:function(c,a,h,f,b,d){var e=new FormData();e.append("file",a,h);this.uploadFormData(c,e,f,b,d)},uploadFormData:function(b,e,f,a,d){var c=true;if(d){c=false}$.ajax({url:b,type:"post",processData:false,contentType:false,timeout:jboltAjaxTimeout,async:c,data:e,success:function(h){if(h.state=="ok"){if(f){f(h)}}else{if(h.msg&&h.msg=="jbolt_system_locked"){showJboltLockSystem()}else{LayerMsgBox.alert(h.msg,2);if(a){a()}}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);
if(a){a()}}});jboltAjaxTimeout=60000},post:function(b,e,f,a,d){var c=true;if(d){c=false}$.ajax({url:b,type:"post",dataType:"json",timeout:jboltAjaxTimeout,async:c,data:e,success:function(h){if(h.state=="ok"){if(f){f(h)}}else{if(h.msg&&h.msg=="jbolt_system_locked"){showJboltLockSystem()}else{LayerMsgBox.alert(h.msg,2);if(a){a()}}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}});jboltAjaxTimeout=60000},get:function(b,e,a,d){var c=true;if(d){c=false}$.ajax({url:b,type:"get",dataType:"json",timeout:jboltAjaxTimeout,async:c,success:function(f){if(f.state=="ok"){if(e){e(f)}}else{if(f.msg&&f.msg=="jbolt_system_locked"){showJboltLockSystem()}else{LayerMsgBox.alert(f.msg,2);if(a){a()}}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}});jboltAjaxTimeout=60000}};function processOptionValue(b,c){var a=b[c];if(!a&&(a=="undefined"||a==undefined)){if(c!="value"){a=b["value"];if(!a&&(a=="undefined"||a==undefined)){a=b["id"]}}else{a=b["id"]}}return a}function processOptionText(e,d){var f="";if(d.indexOf(",")==-1){f=e[d];if(!f&&(f=="undefined"||f==undefined)){if(d!="text"){f=e["text"];if(!f&&(f=="undefined"||f==undefined)){f=e["name"];if(!f&&(f=="undefined"||f==undefined)){f=e["title"]}}}else{if(!f&&(f=="undefined"||f==undefined)){f=e["name"];if(!f&&(f=="undefined"||f==undefined)){f=e["title"]}}}}return f}var a=d.split(",");var c;for(var b in a){c=e[a[b]];f=f+"["+(c?c:"-")+"]"}return f}var SelectUtil={setValueToOther:function(a){var b=a.data("setvalueto");if(b){var f=$("#"+b);if(f&&f.length>0){var e=a.data("text");var c=a.val();if(e){var d=a.find("option").first();if(d.is(":selected")){c.shift()}}f.val(c?c:"");setTimeout(function(){var h=new RegExp("&nbsp;","g");a.next().find("li.select2-selection__choice").each(function(){var i=$(this);if(i.attr("title")==e){i.remove()}else{var j=i.html();j=j.replace(h,"");j=j.replace("├","");i.html(j)}})},60)}}else{LayerMsgBox.alert("请配置data-setvalueto属性",2)}},processItems:function(h,m,k,b,o,c,a){var l=this;var r,q,s,f;var j="&nbsp;&nbsp;&nbsp;&nbsp;";var n="&nbsp;&nbsp;&nbsp;";if(a>2){for(var d=0;d<(a-2);d++){j=j+n}}j=j+" ├ ";for(var d in m){s=m[d];f=s.items;var p=f&&f.length>0;r=j+processOptionText(s,b);q=processOptionValue(s,o);var e='<option value="'+q+'">'+r+"</option>";if(p&&c){e='<optgroup data-value="'+q+'" label="'+r+'">'}else{e='<option value="'+q+'">'+r+"</option>"}if(k){e=k(e,s)}h+=e;if(p){h=l.processItems(h,f,k,b,o,c,(a+1));if(c){h+="</optgroup>"}}}return h},processChangeEventHandler:function(_thisSelect,setting){var that=this;if(setting&&setting.handler){if(setting.handler=="setValueToOther"){that.setValueToOther(_thisSelect)}else{setting.handler(_thisSelect)}}else{var handler=_thisSelect.data("handler");if(handler){if(handler=="setValueToOther"){that.setValueToOther(_thisSelect)}else{var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(_thisSelect)}}}}},readAndInsertItems:function(_thisSelect,setting,refreshing){var that=this;var selectedValue=_thisSelect.data("select");if(refreshing){selectedValue=_thisSelect.val()}var text_attr=_thisSelect.data("text-attr");if(!text_attr){text_attr="text"}var value_attr=_thisSelect.data("value-attr");if(!value_attr){value_attr="value"}var appendHandler=_thisSelect.data("append-handler");if(appendHandler){appendHandler=eval(appendHandler)}_thisSelect.empty();if(_thisSelect.data("text")){_thisSelect.append('<option value="'+_thisSelect.data("value")+'">'+_thisSelect.data("text")+"</option>")}var url=null;if(setting&&setting.url){url=setting.url}else{url=_thisSelect.data("url")}var onlyleaf=_thisSelect.data("onlyleaf");if(url!=null){$.ajax({type:"GET",url:url,dataType:"json",timeout:10000,context:_thisSelect,success:function(result){if(refreshing){LayerMsgBox.closeLoading()}if(result.state=="ok"){var html="";var list=result.data;var text,value,optionItem,option_items;for(var i in list){optionItem=list[i];option_items=optionItem.items;var hasItems=option_items&&option_items.length>0;text=processOptionText(optionItem,text_attr);value=processOptionValue(optionItem,value_attr);var option='<option value="'+value+'">'+text+"</option>";if(hasItems&&onlyleaf){option='<optgroup data-value="'+value+'" label="'+text+'">'}else{option='<option value="'+value+'">'+text+"</option>"}if(appendHandler){option=appendHandler(option,optionItem)}html+=option;if(hasItems){html=that.processItems(html,option_items,appendHandler,text_attr,value_attr,onlyleaf,2);if(onlyleaf){html+="</optgroup>"}}}_thisSelect.append(html);if(selectedValue||(typeof(selectedValue)=="boolean")){selectedValue=selectedValue.toString();if(selectedValue.indexOf(",")!=-1){var arr=selectedValue.split(",");_thisSelect.val(arr)}else{_thisSelect.val(selectedValue)}if(!_thisSelect.val()){var options=_thisSelect.find("option");if(options&&options.length>0){_thisSelect.val(options.eq(0).val())}}}else{if(selectedValue==0||selectedValue=="0"){var options=_thisSelect.find("option[value='0']");if(options&&options.length>0){_thisSelect.val(selectedValue)
}}}_thisSelect.change()}Select2Util.initAutoLoadSelect(_thisSelect)}})}},processRefresh:function(d,c){if(d.data("refresh")){var b=d.parent().find(".fa-refresh");if(b&&b.size()>0){return false}var a=document.createElement("div");a.className="input-group-append hand";a.innerHTML='<i class="fa fa-refresh"></i>';$(a).click(function(){LayerMsgBox.loading("正在刷新数据...",10000);that.readAndInsertItems(d,c,true)});d[0].parentElement.appendChild(a)}},findSelect:function(b){var a=null;if(b){if(b.selectId){if(b.parent){if(typeof b.parent=="object"){if(isDOM(b.parent)){a=$(b.parent).find("#"+b.selectId)}else{a=b.parent.find("#"+b.selectId)}}else{if(b.parent.indexOf("#")!=-1){a=$(b.parent).find("#"+b.selectId)}else{a=$("#"+b.parent).find("#"+b.selectId)}}}else{a=$("#"+b.selectId)}}else{if(b.parent){if(typeof b.parent=="object"){if(isDOM(b.parent)){a=$(b.parent).find("select[data-autoload]")}else{a=b.parent.find("select[data-autoload]")}}else{if(b.parent.indexOf("#")!=-1){a=$(b.parent).find("select[data-autoload]")}else{a=$("#"+b.parent).find("select[data-autoload]")}}}else{a=$("select[data-autoload]")}}}else{a=$("select[data-autoload]")}return a},init:function(d){var e=this;var c=e.findSelect(d);if(c&&c.length>0){var a=c.length;for(var b=0;b<a;b++){e.processOneSelect(c.eq(b),d)}}},processOneSelect:function(d,b){var c=this;c.processLinkAge(d,b);if((d.data("url")||(b&&b.url))){c.readAndInsertItems(d,b,false);c.processRefresh(d,b)}else{var a=d.data("select");if(a){d.val(a)}}},processLinkAge:function(_thisSelect,setting){var that=this;var islinkage=_thisSelect.data("linkage");if(islinkage){_thisSelect.unbind("change")}_thisSelect.on("change",function(){var beforechange=_thisSelect.data("beforechange");if(beforechange){var exe=eval(beforechange);if(exe){exe(_thisSelect)}}that.processChangeEventHandler(_thisSelect,setting);var sonId=_thisSelect.data("sonid");if(islinkage&&sonId){var srcUrl=$("#"+sonId).data("srcurl");var url="";if(srcUrl){if(srcUrl[srcUrl.length-1]=="="){url=srcUrl+_thisSelect.val()}else{url=srcUrl+"/"+_thisSelect.val()}}else{url=$("#"+sonId).data("url")+"/"+_thisSelect.val()}SelectUtil.init({parent:_thisSelect.closest("form"),selectId:sonId,url:url})}})},setValue:function(c,b,a){if(b){$("#"+c).val(b)}else{if(a){$("#"+c).val(a)}}},initAutoSetValue:function(b){var a=getRealJqueryObject(b);if(isOk(a)){a.find("select[data-autosetvalue]").each(function(){var c=$(this);var d=c.data("autosetvalue");c.val(""+d)})}}};$.fn.size=function(){return this.length};function removeTr(a){$(a).closest("tr").remove()}function removeByKey(b){var a=$(b).data("removekey");$("[data-removekey='"+a+"']").remove()}function eleMoveUp(b){var a=b.prev();if(b.index()>0){b.insertBefore(a)}}function eleMoveDown(b){var a=b.next();if(a){b.insertAfter(a)}}var PageOptUtil={init:function(){var a=this;a.initDialogOptEvent();a.initAjaxLinkEvent();a.initPortalLink();a.initAjaxCheckInput()},initAjaxCheckInput:function(){jboltBody.on("blur","input[data-ajax-check-url]",function(c){c.preventDefault();c.stopPropagation();var a=$(this),d=$.trim(a.val()),b=a.data("ajax-check-url");if(d&&b){LayerMsgBox.loading("校验中...",10000);$.ajax({url:b,type:"post",dataType:"json",timeout:10000,data:{"data":d},success:function(e){if(e.state=="ok"){showItCheckSuccessResult(a);LayerMsgBox.closeLoading()}else{if(e.msg&&e.msg=="jbolt_system_locked"){showJboltLockSystem()}else{showItCheckFailResult(a);LayerMsgBox.error(e.msg,1500)}}},error:function(){showItCheckFailResult(a);LayerMsgBox.error("网络通讯异常",1500)}})}return false})},initDialogOptEvent:function(){jboltBody.on("click","[data-dialogbtn]",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})},initAjaxLinkEvent:function(){jboltBody.on("click","[data-ajaxbtn]",function(e){e.preventDefault();e.stopPropagation();var action=$(this);var url=action.attr("href");if(!url){url=action.data("url")}if(!url){alert("请设置URL地址");return false}var okhandler=action.attr("handler");if(!okhandler){okhandler=action.data("handler")}var dataconfirm=action.data("confirm");var dataloading=action.data("loading");var ajaxFun=function(){var timeout=action.data("timeout");if(timeout){jboltAjaxTimeout=timeout}LayerMsgBox.loading(dataloading,jboltAjaxTimeout);Ajax.get(url,function(data){if(okhandler){LayerMsgBox.closeLoadingNow();if(okhandler=="removeTr"){removeTr(action)}else{if(okhandler=="removeByKey"){removeByKey(action)}else{if(okhandler=="moveUp"){eleMoveUp(action.closest("tr"))}else{if(okhandler=="moveDown"){eleMoveDown(action.closest("tr"))}else{if(okhandler=="refreshPortal"){var portalId=action.data("portal");if(portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+portalId).ajaxPortal(true)})}}else{var exe_handler=eval(okhandler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(data)}}}}}}}else{LayerMsgBox.success("操作成功",600)}})};if(dataconfirm){LayerMsgBox.confirm(dataconfirm,ajaxFun)
}else{ajaxFun()}return false})},initPortalLink:function(){jboltBody.on("click","[data-portalbtn]",function(f){f.preventDefault();f.stopPropagation();var d=$(this);var b=d.data("portalid");if(!b){alert("请设置data-portalid");return false}var c=d.attr("href");if(!c){c=d.data("url")}if(!c){alert("请设置URL地址");return false}var a=$("#"+b);if(!a||a.length==0){alert("data-portalid不正确");return false}LayerMsgBox.loading("正在匹配...",30000);a.ajaxPortal(true,c,true,function(){LayerMsgBox.success("匹配完成",500)})})}};var TableUtil={init:function(){var a=this;a.initDelOptEvent();a.initEditOptEvent();a.initAddOptEvent()},initDelOptEvent:function(){jboltDocument.on("click",".jbolt_table_delbtn",function(e){e.preventDefault();e.stopPropagation();var action=$(this);var url=action.attr("href");var okhandler=action.attr("handler");if(!okhandler){okhandler=action.data("handler")}var confirm=action.data("confirm");LayerMsgBox.confirm(confirm?confirm:"确定删除此项？",function(){LayerMsgBox.loading("删除中",10000);Ajax.get(url,function(ret){LayerMsgBox.closeLoading();LayerMsgBox.success(ret.msg?ret.msg:"操作成功");if(okhandler){if(okhandler=="removeTr"){removeTr(action)}else{if(okhandler=="removeByKey"){removeByKey(action)}else{if(okhandler=="refreshPortal"){var portalId=action.data("portal");if(portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+portalId).ajaxPortal(true)})}}else{var exe_handler=eval(okhandler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}}}}}})});return false})},initEditOptEvent:function(){jboltDocument.on("click",".jbolt_table_editbtn",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})},initAddOptEvent:function(){jboltDocument.on("click",".jbolt_table_addbtn",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})}};var FormDate={initDate:function(dateEle){var dateType=dateEle.data("type");if(!dateType){dateType="date"}var datefmt=dateEle.data("fmt");if(!datefmt){switch(dateType){case"date":datefmt="yyyy-MM-dd";break;case"time":datefmt="HH:mm";break;case"datetime":datefmt="yyyy-MM-dd HH:mm";break;default:datefmt="yyyy-MM-dd";break}}var id=dateEle.attr("id");if(!id){id=dateEle.attr("name");id=id.replace(".","");dateEle.attr("id",id)}var minutes=dateEle.data("minutes");var changeHandler=dateEle.data("changehandler");var doneHandler=dateEle.data("donehandler");dateEle.attr("lay-key","");laydate.render({elem:"#"+id,type:dateType,format:datefmt,trigger:"click",ready:function(date){if(datefmt.indexOf("ss")==-1&&dateType!="month"&&dateType!="year"){$(".layui-laydate").addClass("noseconds");$(".layui-laydate .laydate-time-list li ol").eq(2).find("li").remove()}if(minutes&&datefmt.indexOf("HH:mm")!=-1){var minutesArr=minutes.split(",");var box=$(".layui-laydate .laydate-time-list li ol").eq(1);box.find("li").each(function(){var value=this.innerText;var inArr=$.inArray(value,minutesArr);if(inArr==-1){$(this).remove()}})}},change:function(value,date,endDate){if(changeHandler){var change_handler=eval(changeHandler);if(change_handler&&typeof(change_handler)=="function"){change_handler(dateEle,value)}}},done:function(value,date,endDate){if(doneHandler){var done_handler=eval(doneHandler);if(done_handler&&typeof(done_handler)=="function"){done_handler(dateEle,value)}}},})},initDates:function(c){if(!isOk(c)){return false}c.attr("readonly","readonly");var a=c.length;for(var b=0;b<a;b++){this.initDate(c.eq(b))}},init:function(b){var a=getRealJqueryObject(b);if(!isOk(a)){return false}var c=a.find("[data-date]");if(!isOk(c)){return false}this.initDates(c)}};var DialogUtil={openBy:function(s){var f=$(s);var b=f.data("url");if(!b){b=f.attr("href")}var q=f.data("contentid");if(!b&&!q){LayerMsgBox.alert("没有设置dialog的url. href 或者 dialog-url",2);return false}var o=f.data("title");var r=f.attr("handler");if(!r){r=f.data("handler")}var i=f.data("area");var p="800px";var l="500px";if(i){var c=i.split(",");var j=c[0];var e=c[1];if(j.indexOf("px")!=-1||j.indexOf("%")!=-1){p=j}else{p=j+"px"}if(e.indexOf("px")!=-1||e.indexOf("%")!=-1){l=e}else{l=e+"px"}}var a=f.data("scroll");if(!a){a="no"}else{a="yes"}var m=f.data("fs");if(m&&(m=="true"||m==true)){a="yes"}var n=f.data("cdrfp");if(n==undefined){n=false}var k=f.data("portalid");if(!k){k=f.data("portal")}var d=f.data("btn");this.openNewDialog({title:o,width:p,height:l,url:b,scroll:a,btn:d,handler:r,cdrfp:n,fs:m,portalId:k,contentId:q})},openNewDialog:function(options){var btn=[];var dbtn=options.btn;if(!dbtn){btn=["确定","关闭"]}else{if(dbtn&&dbtn=="no"){btn=[]}else{if(dbtn&&dbtn=="close"){btn=["确定","关闭"]}}}var type=2;if(!(options.url)&&options.contentId){type=1}var content="";if(type==1){content=$("#"+options.contentId)}else{content=[options.url,options.scroll]
}var lindex=layer.open({type:type,title:options.title,shadeClose:false,shade:0.5,maxmin:true,area:[options.width,options.height],content:content,btn:btn,yes:function(index){if(type==2){var iframeWin=window[$(".layui-layer-iframe").find("iframe")[0]["name"]];iframeWin.submitThisForm(function(){LayerMsgBox.close(index);if(options.handler){if(options.handler=="refreshPortal"){if(options.portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+options.portalId).ajaxPortal(true)})}else{LayerMsgBox.alert("没有配置data-portalid",2)}}else{var exe_handler=eval(options.handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler()}}}})}},end:function(){if(options.cdrfp){refreshPjaxContainer()}}});if(options.fs){layer.full(lindex)}if(dbtn&&dbtn=="close"){$("#layui-layer"+lindex).find("a.layui-layer-btn0").hide()}if(dbtn&&dbtn=="no"){$("#layui-layer"+lindex).find(".layui-layer-btn").remove()}}};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};Date.prototype.format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a};function isArray(a){return(typeof a=="object")&&a.constructor==Array}function isEmpty(a){return(a=="undefined"||a==null||a==""||a==false)}function isNotEmpty(a){return((a!=null&&a!="undefined"&&a!="")||a==true)}jQuery.fn.shake=function(a,c,b){this.each(function(){var e=$(this);e.css({position:"relative"});for(var d=1;d<=a;d++){e.animate({left:(c*-1)},(((b/a)/4))).animate({left:c},((b/a)/2)).animate({left:0},(((b/a)/4)))}});return this};function processCheckTab(a){var b=a.closest("div[role='tabpanel']");if(b&&b.size()==1){var c=b.attr("id");$(".nav.nav-tabs .nav-item.nav-link[href='#"+c+"']").tab("show")}}function showItCheckFailResult(a){if(a.is("input")&&a.attr("type")=="hidden"){return}a.parents(".form-group").removeClass("bdc-success").addClass("bdc-danger");a.shake(2,10,400);a.focus()}function showItCheckSuccessResult(a){if(a.is("input")&&a.attr("type")=="hidden"){return}a.parents(".form-group").removeClass("bdc-danger").addClass("bdc-success")}function TestRgexp(b,a){return b.test(a)}var vcity={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};var IdCardNoCheckUtil={isCardNo:function(a){var b=/(^\d{15}$)|(^\d{17}(\d|X)$)/;if(!b.test(a)){return false}return true},checkProvince:function(b){var a=b.substr(0,2);if(vcity[a]==undefined){return false}return true},checkBirthday:function(a){var b=a.length;if(b=="15"){var j=/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/;var d=a.match(j);var e=d[2];var c=d[3];var f=d[4];var h=new Date("19"+e+"/"+c+"/"+f);return this.verifyBirthday("19"+e,c,f,h)}if(b=="18"){var i=/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/;var d=a.match(i);var e=d[2];var c=d[3];var f=d[4];var h=new Date(e+"/"+c+"/"+f);return this.verifyBirthday(e,c,f,h)}return false},verifyBirthday:function(d,h,a,e){var b=new Date();var c=b.getFullYear();if(e.getFullYear()==d&&(e.getMonth()+1)==h&&e.getDate()==a){var f=c-d;if(f>=3&&f<=100){return true}return false}return false},checkParity:function(e){e=this.changeFivteenToEighteen(e);var b=e.length;if(b=="18"){var d=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var a=new Array("1","0","X","9","8","7","6","5","4","3","2");var h=0,f,c;for(f=0;f<17;f++){h+=e.substr(f,1)*d[f]}c=a[h%11];if(c==e.substr(17,1)){return true}return false}return false},changeFivteenToEighteen:function(c){if(c.length=="15"){var b=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var a=new Array("1","0","X","9","8","7","6","5","4","3","2");var e=0,d;c=c.substr(0,6)+"19"+c.substr(6,c.length-6);for(d=0;d<17;d++){e+=c.substr(d,1)*b[d]}c+=a[e%11];return c}return c}};function checkIdCardNo(a){if(a===""){LayerMsgBox.alert("请输入身份证号，身份证号不能为空",2);return false}if(IdCardNoCheckUtil.isCardNo(a)===false){LayerMsgBox.alert("您输入的身份证号码不正确，请重新输入",2);return false}if(IdCardNoCheckUtil.checkProvince(a)===false){LayerMsgBox.alert("您输入的身份证号码不正确,请重新输入",2);return false}if(IdCardNoCheckUtil.checkBirthday(a)===false){LayerMsgBox.alert("您输入的身份证号码生日不正确,请重新输入",2);return false}if(IdCardNoCheckUtil.checkParity(a)===false){LayerMsgBox.alert("您的身份证校验位不正确,请重新输入",2);return false}return true}var ruleMap=[{type:"number",method:function(a){return(!isNaN(a))}},{type:"pznumber",method:function(a){return(!isNaN(a)&&a*1>=0)}},{type:"pzint",method:function(a){return((TestRgexp(/^-?[0-9]\d*$/,a))&&(a*1>=0))}},{type:"pnumber",method:function(a){return(!isNaN(a)&&a*1>0)}},{type:"int",method:function(a){return TestRgexp(/^-?[0-9]\d*$/,a)
}},{type:"pint",method:function(a){return TestRgexp(/^[0-9]*[1-9][0-9]*$/,a)}},{type:"email",method:function(a){return TestRgexp(/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,a)}},{type:"filepath",method:function(a){return TestRgexp(/^([a-zA-Z]){1}:(\\[^\/\\:\*\?\"<>]+)*(\\)?$/,a)}},{type:"url",method:function(a){return TestRgexp(/^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)(([A-Za-z0-9-~]+)\.)+([A-Za-z0-9-~\/])+$/,a)}},{type:"url_nohttp",method:function(a){return TestRgexp(/^((https|http|ftp|rtsp|mms){0,1}(:\/\/){0,1})(([A-Za-z0-9-~]+)\.)+([A-Za-z0-9-~\/])+$/,a)}},{type:"date",method:function(a){return TestRgexp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/,a)}},{type:"time",method:function(a){return TestRgexp(/^(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,a)}},{type:"time_hm",method:function(a){return TestRgexp(/^(20|21|22|23|[0-1]\d):[0-5]\d$/,a)}},{type:"datetime",method:function(a){return TestRgexp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d:[0-5]\d$/,a)}},{type:"datetime_hm",method:function(a){return TestRgexp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])\s+(20|21|22|23|[0-1]\d):[0-5]\d$/,a)}},{type:"money",method:function(a){return TestRgexp(/(^[1-9]\d*(\.\d{1,2})?$)|(^0(\.\d{1,2})?$)/,a)}},{type:"money_4",method:function(a){return TestRgexp(/(^[1-9]\d*(\.\d{1,4})?$)|(^0(\.\d{1,4})?$)/,a)}},{type:"phone",method:function(a){return TestRgexp(/0?(13|14|15|18)[0-9]{9}/,a)}},{type:"tel",method:function(a){return TestRgexp(/[0-9-()（）]{7,18}/,a)}},{type:"zh_cn",method:function(a){return TestRgexp(/[\u4e00-\u9fa5]/,a)}},{type:"ip",method:function(a){return TestRgexp(/(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)\.(25[0-5]|2[0-4]\d|[0-1]\d{2}|[1-9]?\d)/,a)}},{type:"postalcode",method:function(a){return TestRgexp(/\d{6}/,a)}},{type:"idcardno",method:function(a){return checkIdCardNo(a)}},{type:"password",method:function(b){if(!b){return false}var a=b.length;return a>=6&&a<=16}}];var isDOM=(typeof HTMLElement==="object")?function(a){return a instanceof HTMLElement}:function(a){return a&&typeof a==="object"&&a.nodeType===1&&typeof a.nodeName==="string"};var FormChecker={checkIt:function(h){var d=this;var c=null;if(typeof h=="string"){c=$("#"+h)}else{if(typeof h=="object"){if(isDOM(h)){c=$(h)}else{c=h}}}var e=true;if(c.is(":disabled")){return true}if(typeof(c.data("rule"))!="undefined"){var a=d.checktype(c);var f=c.next().hasClass("input-group-addon");var i=c.prev().hasClass("input-group-addon");var b=c.is("textarea");if(!a){e=false;if(c.is("input")&&c.attr("type")=="hidden"){return}c.parents(".form-group").removeClass("bdc-success").addClass("bdc-danger");processCheckTab(c);c.shake(2,10,400);c.focus();if(c.is("input")&&c.attr("type")=="file"){return}}else{e=true;if(c.is("input")&&c.attr("type")=="hidden"){return}c.parents(".form-group").removeClass("bdc-danger").addClass("bdc-success");if(c.is("input")&&c.attr("type")=="file"){return}}}return e},check:function(d){var a=null;if(typeof d=="string"){a=$("#"+d)}else{if(typeof d=="object"){if(isDOM(d)){a=$(d)}else{a=d}}}var b=this;var c=true;a.find("input,textarea,select,[data-rule='checkbox'],[data-rule='radio']").each(function(){if(!c){return c}var h=$(this);if(h.is(":disabled")){return true}if(typeof(h.data("rule"))!="undefined"){var e=b.checktype(h);var i=h.next().hasClass("input-group-addon");var j=h.prev().hasClass("input-group-addon");var f=h.is("textarea");if(!e){c=false;if(h.is("input")&&h.attr("type")=="hidden"){return}h.parents(".form-group").removeClass("bdc-success").addClass("bdc-danger");processCheckTab(h);h.shake(2,10,400);h.focus();if(h.is("input")&&h.attr("type")=="file"){return}}else{c=true;if(h.is("input")&&h.attr("type")=="hidden"){return}h.parents(".form-group").removeClass("bdc-danger").addClass("bdc-success");if(h.is("input")&&h.attr("type")=="file"){return}}}});return c},checkCheckboxRequired:function(d,f,b){var c=this;var e=d.data("name");if(!e){return false}var h=$("input[type='checkbox'][name='"+e+"']:checked");if(h&&h.length>0){d.removeClass("bdc-danger").addClass("bdc-success");return true}d.removeClass("bdc-success").addClass("bdc-danger");d.shake(2,10,400);d.focus();var a=d.data("tips");if(!a){a="必须选择至少一个选项"}c.showMyTipsIfNeed(d,a,b);return false},checkSelectRequired:function(b,e,c){var d=this;var h=b.val();var f=(h&&h!=""&&h!="0"&&h!="-1"&&h.length>0);if(f){b.removeClass("bdc-danger").addClass("bdc-success");return true}b.removeClass("bdc-success").addClass("bdc-danger");b.shake(2,10,400);b.focus();var a=b.data("tips");if(!a){a="必须选择一个选项"}d.showMyTipsIfNeed(b,a,c);return false},checkRadioRequired:function(d,f,b){var c=this;var e=d.data("name");if(!e){return false}var h=$("input[type='radio'][name='"+e+"']:checked");if(h&&h.length>0){d.removeClass("bdc-danger").addClass("bdc-success");return true}d.removeClass("bdc-success").addClass("bdc-danger");d.shake(2,10,400);d.focus();var a=d.data("tips");if(!a){a="必须选择至少一个选项"
}c.showMyTipsIfNeed(d,a,b);return false},checktype:function(c){var b=this;var f=c.data("rule");if(!f){return true}var d=c.data("tips"),a=c.data("show"),e=c.data("notnull");var h=null;if(f=="checkbox"){if(e==null||e==true||e=="true"){return b.checkCheckboxRequired(c,d,a)}else{return true}}else{if(f=="radio"){if(e==null||e==true||e=="true"){return b.checkRadioRequired(c,d,a)}else{return true}}else{if(f=="select"){if(e==null||e==true||e=="true"){return b.checkSelectRequired(c,d,a)}else{return true}}else{h=c.val()}}}if(a!=null){g(a).innerHTML=""}if(typeof h=="string"){h=h.trim()}if(!h){if(e==null||e==true||e=="true"){if(!d){if(c.attr("type")=="file"){d="此文件必须上传"}else{d="必填项"}}if(a==null){LayerMsgBox.error("<span class='j_text_danger'>"+d+"</span>",1500)}else{g(a).innerHTML=d}return false}else{return true}}return b.checkTypes(c,f,h,d,a,e)},checkTypes:function(k,j,l,e,m,c){var o=this;var f=j.split(";");var a=true;var h=1;var n=2;var b=3;for(var d=0;d<f.length;d++){var j=f[d];var p=o.checkSelf(k,j,l,e,m,c);if(p!=b){if(p==n){continue}else{a=false;break}}p=o.checkCompare(k,j,l,e,m,c);if(p!=b){if(p==n){continue}else{a=false;break}}}return a},checkCompare:function(h,e,i,d,j,c){var m=this;var f=1;var k=2;var b=3;var a=m.getRealTypeValue(i);var l=m.getCompareValue(e);if(e.indexOf("len=")!=-1){if(i.length==l){return k}if(!d){d="长度必须等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len>=")!=-1){if(i.length>=l){return k}if(!d){d="长度必须大于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len>")!=-1){if(i.length>l){return k}if(!d){d="长度必须大于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf(">=")!=-1){if(a>=l){return k}if(!d){d="必须大于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len<=")!=-1){if(i.length<=l){return k}if(!d){d="长度必须小于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len<")!=-1){if(i.length<l){return k}if(!d){d="长度必须小于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("<=")!=-1){if(a<=l){return k}if(!d){d="必须小于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf(">")!=-1){if(a>l){return k}if(!d){d="必须大于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("<")!=-1){if(a<l){return k}if(!d){d="必须小于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("!=")!=-1){if(a!=l){return k}if(!d){d="不能等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("==")!=-1){if(a==l){return k}if(!d){if(e.indexOf("#")!=-1){d="必须等于id为["+e.substring(e.indexOf("#")+1)+"]元素的值"}else{d="必须等于"+l}}m.showMyTipsIfNeed(h,d,j);return f}}}}}}}}}}}return b},getRealTypeValue:function(a){if(!isNaN(a)){return Number(a)}return a},getCompareValue:function(b){var a=this;if(b.indexOf("#")!=-1){var c=b.substring(b.indexOf("#"));return a.getRealTypeValue($(c).val())}else{if(b.indexOf("len=")!=-1){return a.getRealTypeValue(b.substring(4))}if(b.indexOf("len")!=-1){b=b.substring(3)}if(b.indexOf("=")!=-1){return a.getRealTypeValue(b.substring(2))}else{return a.getRealTypeValue(b.substring(1))}}},showMyTipsIfNeed:function(b,c,a){if(c!=null){if(a==null){LayerMsgBox.error("<span class='j_text_danger'>"+c+"</span>",3000)}else{g(a).innerHTML=c}}},checkSelf:function(j,f,k,e,l,c){var n=this;var h=1;var m=2;var b=3;if(f=="string"){return m}var a=false;for(var d=0;d<ruleMap.length;d++){if(f==ruleMap[d].type){a=true;var o=ruleMap[d].method.call(this,k);if(!o){if(!e){switch(f){case"email":e="Email格式不正确";break;case"phone":e="手机号格式不正确";break;case"tel":e="电话号码格式不正确";break;case"money":e="必须为金额(价格)格式 默认最多小数点后保留2位";break;case"money_4":e="必须为金额(价格)格式 最多小数点后保留4位";break;case"number":e="必须为数字";break;case"pnumber":e="必须为正数";break;case"pznumber":e="不能为负数";break;case"pzint":e="必须为0或正整数";break;case"int":e="必须为整数";break;case"pint":e="必须为正整数";break;case"date":e="必须为日期格式 例：2019-01-01";break;case"time":e="必须为时间格式 例：12:59:59";case"time_hm":e="必须为时间格式 例：12:59";break;case"datetime":e="必须为完整日期时间格式 例：2019-01-01 12:59:59";break;case"datetime_hm":e="必须为日期时间格式 例：2019-01-01 12:59";break;case"idnum":e="必须为18位身份证号 例：370523198901033922";break;case"postalcode":e="必须为6位邮政编码 例：6473098";break;case"zh_cn":e="必须为中文";break;case"ip":e="必须为IP地址正确格式 例：127.0.0.1";break;case"password":e="密码长度必须为6~16个字符";break;case"select":e="必须选择一项";break}}n.showMyTipsIfNeed(j,e,l);return h}}}return a?m:b}};function initAdminLeftNav(){var a=localStorage.getItem("jbolt_hideMenu");if(a=="true"){$(".jbolt_admin_nav.expansion").removeClass("expansion");$(".jbolt_admin").addClass("hideMenu")}else{$(".jbolt_admin").addClass("normalMenu")}resizeMorris();jboltBody.on("click",".jbolt_admin_left_navs .jbolt_admin_nav .jbolt_menu_group",function(){$(".jbolt_admin").removeClass("hideMenu").addClass("normalMenu");localStorage.setItem("jbolt_hideMenu",false);var d=$(".jbolt_admin_left_navs");var c=$(this);var i=c.closest("nav");var b=$(".jbolt_admin_left_navs .jbolt_admin_nav.expansion");if(!c.hasClass("l1link")){if(d.hasClass("allexpansion")){return false}var h=b.data("key");var e=i.data("key");var f=c.find("i.fa").last();if(f.hasClass("fa-angle-down")){f.removeClass("fa-angle-down").addClass("fa-angle-left")
}else{f.removeClass("fa-angle-left").addClass("fa-angle-down")}if(h!=e){b.removeClass("expansion")}$(this).parent().toggleClass("expansion")}else{b.removeClass("expansion");b.find(".jbolt_menu_group i.fa.fa-angle-down").removeClass("fa-angle-down").addClass("fa-angle-left");i.addClass("expansion");i.find(".jbolt_menu_group i.fa.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-down")}});jboltBody.on("mouseover",".jbolt_admin.hideMenu  nav.jbolt_admin_nav",function(f){var c=$(this).find("ul.jbolt_admin_menus").first(),d=parseInt(c.css("top")),b=(jboltWindowHeight-d)+"px";c.css({"max-height":b})})}function sendPjax(b,a,c){$.pjax({url:b,container:a,extData:c})}function pjaxSubmitForm(b){var d=$(b);var c=b.action;var a=d.serialize();if(c.indexOf("?")!=-1){c=c+"&"+a}else{c=c+"?"+a}$.pjax({url:c,container:mainPjaxContainerId});return false}function initAdminPjax(){$.pjax.defaults.timeout=5000;jboltDocument.pjax("a[data-pjax]:not([target]),[data-pjax] a:not([target])",mainPjaxContainerId);jboltDocument.on("pjax:timeout",function(a){LayerMsgBox.closeAll();a.preventDefault()});jboltDocument.on("submit","form[data-pjaxsubmit]",function(a){var b=$(this).data("needcheck");if(b){if(FormChecker.check(this)){$.pjax.submit(a,mainPjaxContainerId)}}else{$.pjax.submit(a,mainPjaxContainerId)}return false});jboltDocument.on("pjax:start",function(){LayerMsgBox.load(3)});jboltDocument.on("pjax:end",function(){afterPjax();LayerMsgBox.closeAll()});afterPjax()}function refreshCurrentTabContent(){var a=JBoltTabUtil.getCurrentTabContent();if(a&&a.length==1){LayerMsgBox.load(3);a.ajaxPortal(true,null,true,function(){LayerMsgBox.closeLoad()})}}function isIE(){if(!!window.ActiveXObject||"ActiveXObject" in window){return true}else{return false}}function refreshPjaxContainer(){if(self!=top){reloadCurrentPage()}else{var a=isWithtabs();if(a){refreshCurrentTabContent()}else{if(isIE()){reloadCurrentPage()}else{$.pjax.reload(mainPjaxContainerId)}}}}function initOpenLeftNav(){var c=isWithtabs();var e=null;if(c){var d=JBoltTabUtil.getCurrentTabContent();if(d&&d.length==1){e=d.find("div.jbolt_page[data-key]:first")}}else{e=$("div.jbolt_page[data-key]:first")}if(e&&e.length==1){var b=e.data("key");var a=e.data("dontchangeleftnav");if(!a){openLeftNav(b)}}}function openLeftNav(b){var e=$(".jbolt_admin_left_navs nav.jbolt_admin_nav a.active");if(e.attr("href")==b){return false}e.removeClass("active");var a=$(".jbolt_admin_nav.expansion");a.removeClass("expansion");a.find(".jbolt_menu_group i.fa.fa-angle-down").removeClass("fa-angle-down").addClass("fa-angle-left");var c=$(".jbolt_admin_left_navs nav.jbolt_admin_nav a[href='"+b+"']");c.addClass("active");var d=c.closest("nav");if(d&&d.size()==1){d.addClass("expansion");d.find(".jbolt_menu_group i.fa.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-down")}}function afterPjax(){$(".tooltip.show").remove();initOpenLeftNav();SelectUtil.initAutoSetValue(mainPjaxContainer);JAtomFileUploadUtil.init(mainPjaxContainer);JAtomImgUploader.init(mainPjaxContainer);SwitchBtnUtil.init(mainPjaxContainer);FormDate.init(mainPjaxContainer);LayerTipsUtil.init(mainPjaxContainer);HtmlEditorUtil.init(mainPjaxContainer);MasterSlaveUtil.init(mainPjaxContainer);ImageViewerUtil.init(mainPjaxContainer);RadioUtil.init(mainPjaxContainer);CheckboxUtil.init(mainPjaxContainer);AutocompleteUtil.init(mainPjaxContainer);Select2Util.init(mainPjaxContainer);SelectUtil.init({parent:mainPjaxContainer});initToolTip(mainPjaxContainer);MultipleFileInputUtil.init(mainPjaxContainer);initAjaxPortal(mainPjaxContainer)}function getCheckedIds(b){var c=new Array();var a=$("input[name='"+b+"']:checked");a.each(function(d){c.push($(this).val())});if(c.length>0){return c.join(",")}return""}function jboltPageSubmitForm(b,d,f,h){var a=d.closest(".pages");if(!h){var e=a.find("#gonu");if(e&&e.length>0){h=e.val()}else{h=1}}var c=a.find("#jbolt_pagesize").val();f.append('<input type="hidden" name="page" value="'+h+'"/>');f.append('<input type="hidden" name="pageSize" value="'+c+'"/>');f.submit()}function initPage(b,h,l,m){var c=isWithtabs();var e=null;var d=$("#"+b);var f=d.closest("[data-ajaxportal]");if(f&&f.length==1){e=f}else{if(c){e=JBoltTabUtil.getCurrentTabContent()}else{e=$(mainPjaxContainer);var j=!(e&&e.length==1);if(j){e=$("body .jbolt_page");var i=!(e&&e.length==1);if(i){e=jboltBody}}}}if(!e){return false}var a=e.find("#"+m);var k=a.attr("action");d.pagination(h,{num_edge_entries:1,current_page:(l-1),callback:function(n,o){if(isNaN(n)==false){var p=n+1;jboltPageSubmitForm(e,d,a,p);return false}}});e.find("#gonu").one("keydown",function(n){if(n.keyCode==109||n.keyCode==189){return false}});e.find(".page-btn").one("click",function(){jboltPageSubmitForm(e,d,a)});e.find("#jbolt_pagesize").one("change",function(){jboltPageSubmitForm(e,d,a,1)})}function toggleMenuEvent(){jboltBody.on("click",".jbolt_toggle_Left_nav_btn",function(){$(this).toggleClass("hidden");$(".jbolt_admin_nav.expansion").removeClass("expansion");$(".jbolt_admin").toggleClass("hideMenu").toggleClass("normalMenu");
$(".jbolt_admin_left_navs nav.jbolt_admin_nav a.active").removeClass("active");var a=$(".jbolt_admin").hasClass("hideMenu");if(!a){initOpenLeftNav()}localStorage.setItem("jbolt_hideMenu",a);resizeMorris()})}function resizeMorris(){setTimeout(function(){windowResize()},1000)}function windowResize(){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("resize",true,true);window.dispatchEvent(a)}else{if(document.createEventObject){window.fireEvent("onresize")}}}function goback(){history.go(-1)}function reloadCurrentPage(){var a=self.location.href;if(a.indexOf("globalconfig")!=-1){self.location.href="/admin"}else{history.go(0)}}function hideParentLayerDialogBtn(a){if(a==0||a==1){parent.$(".layui-layer-btn .layui-layer-btn"+a).hide()}else{hideAllParentLayerDialogBtn()}}function hideAllParentLayerDialogBtn(){parent.$(".layui-layer-btn").hide()}function changeParentLayerDialogBtnTitle(a,b){parent.$(".layui-layer-btn .layui-layer-btn"+a).text(b)}function changeParentLayerDialogOkBtnTitle(a){changeParentLayerDialogBtnTitle(0,a)}function changeParentLayerDialogCancelBtnTitle(a){changeParentLayerDialogBtnTitle(1,a)}function getParentLayerDialogBtn(a){return parent.$(".layui-layer-btn .layui-layer-btn"+a)}function showParentLayerDialogBtn(a){if(a){parent.$(".layui-layer-btn .layui-layer-btn"+a).show()}else{parent.$(".layui-layer-btn").show()}}function checkExistLayerDialogBtn(c,a){var d=parent.$(".layui-layer-btn").find("a."+a);var b=null;if(d&&d.length>0){d.each(function(){var e=$(this);if($.trim(e.text())==$.trim(c)){b=e;return false}})}return b}function addParentLayerDialogBtn(e,b,a){var h=checkExistLayerDialogBtn(e,b);var f;if(h==null){var d=randomId();f="lay_btn_"+d;var c=$("<a id='"+f+"' class='"+b+"'>"+e+"</a>");c.on("click",function(i){i.preventDefault();i.stopPropagation();if(a){a()}});parent.$(".layui-layer-btn").find("a.layui-layer-btn0").after(c)}else{f=h.attr("id");h.off("click").on("click",function(i){i.preventDefault();i.stopPropagation();if(a){a()}})}return f}function ajaxSubmitForm(a,d){var c=getRealJqueryObject(a);if(isOk(c)){if(FormChecker.check(c)){var b=c.action;c.ajaxSubmit({type:"post",url:b,success:function(e){if(e.state=="ok"){if(d){LayerMsgBox.success(e.msg,500,d)}else{LayerMsgBox.success(e.msg,500)}}else{LayerMsgBox.alert(e.msg,2)}}})}}return false}function getRealJqueryObject(b){if(!b){return jboltBody}var a=typeof b;var c=null;if(a=="string"){if(b.indexOf("#")!=-1){c=$(b)}else{c=$("#"+b)}}else{if(a=="object"){if(isDOM(b)){c=$(b)}else{c=b}}}return c}function closeCurrentAndReloadTiggerTab(a){var d=isWithtabs();if(d){var c=JBoltTabUtil.getCurrentTab();if(c&&c.length>0){if(a){JBoltTabUtil.showJboltTab(a,false,function(){JBoltTabUtil.close(c);refreshPjaxContainer()})}else{var b=c.data("trigger-tab-key");if(b&&JBoltTabUtil.isJboltTabExist(b)){JBoltTabUtil.showJboltTab(b,false,function(){JBoltTabUtil.close(c);refreshPjaxContainer()})}else{JBoltTabUtil.close(c)}}}}else{refreshPjaxContainer()}}function pageFormSubmit(a){var b=getRealJqueryObject(a);if(isOk(b)){if(FormChecker.check(b)){b.attr("onsubmit","return true;");b.submit()}}return false}function submitFormInCurrentTab(a,i){var d=getRealJqueryObject(a);if(isOk(d)){if(FormChecker.check(d)){var h=isWithtabs();if(h){var c=JBoltTabUtil.getCurrentTabContent();if(c&&c.length==1){var f=d.serialize();var e=d.attr("action");var b=e;if(b.indexOf("?")!=-1){b=b+"&"+f}else{b=b+"?"+f}LayerMsgBox.load(3);c.ajaxPortal(true,b,true,function(){LayerMsgBox.closeLoad();if(i){i()}})}}else{ajaxSubmitForm(d,i)}}}return false}function initJboltAdminTopStyleChange(){var a=$(".jbolt_admin_main_top");initToolTip(a)}function isWithtabs(){var a=$(".jbolt_admin.withtabs");return a&&a.length==1}function tabContentFormSubmitWithAjaxPortal(c){var b=JBoltTabUtil.getCurrentTabContent();if(b&&b.length==1){var e=c.serialize();var d=c.attr("action");var a=d;if(a.indexOf("?")!=-1){a=a+"&"+e}else{a=a+"?"+e}LayerMsgBox.load(3);b.ajaxPortal(true,a,true,function(){LayerMsgBox.closeLoad()})}}function currentTabContentRedirectWithAjaxPortal(a){var b=JBoltTabUtil.getCurrentTabContent();if(b&&b.length==1){LayerMsgBox.load(3);b.ajaxPortal(true,a,true,function(){LayerMsgBox.closeLoad()})}}function initAdminAjaxPortalFormSubmitEvent(){jboltDocument.on("submit",".jbolt_page_title form,form[data-submittabportal]",function(b){b.preventDefault();b.stopPropagation();var a=$(this);var c=a.data("needcheck");if(c==undefined||c==null||c=="undefined"||c==""){c=true}if(c){if(FormChecker.check(this)){tabContentFormSubmitWithAjaxPortal(a)}}else{tabContentFormSubmitWithAjaxPortal(a)}return false})}function toggleInputHidden(c){if(c.indexOf(",")!=-1){var b=c.split(",");for(var a in b){toggleOneInputHidden(b[a])}}else{toggleOneInputHidden(c)}}function toggleOneInputHidden(b){var a=g(b);if(a.type=="hidden"){a.type="text"}else{a.type="hidden"}}(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150,noRecord:"No Records."},c);
c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(n,h){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var j=null;if(h.failure!=null&&typeof h.failure=="function"){j=h.failure}var b=a(n).attr("autocomplete","off").addClass(h.inputClass);var l;var s="";var o=a.Autocompleter.Cache(h);var e=0;var w;var z={mouseDownOnSelect:false};var t=a.Autocompleter.Select(h,n,d,z);var y;navigator.userAgent.indexOf("Opera")!=-1&&a(n.form).bind("submit.autocomplete",function(){if(y){y=false;return false}});b.bind((navigator.userAgent.indexOf("Opera")!=-1&&!"KeyboardEvent" in window?"keypress":"keydown")+".autocomplete",function(A){e=1;w=A.keyCode;switch(A.keyCode){case c.UP:if(t.visible()){A.preventDefault();t.prev()}else{v(0,true)}break;case c.DOWN:if(t.visible()){A.preventDefault();t.next()}else{v(0,true)}break;case c.PAGEUP:if(t.visible()){A.preventDefault();t.pageUp()}else{v(0,true)}break;case c.PAGEDOWN:if(t.visible()){A.preventDefault();t.pageDown()}else{v(0,true)}break;case h.multiple&&a.trim(h.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){A.preventDefault();y=true;return false}break;case c.ESC:t.hide();break;default:clearTimeout(l);l=setTimeout(v,h.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!z.mouseDownOnSelect){u()}}).click(function(){if(h.clickFire){if(!t.visible()){v(0,true)}}else{if(e++>1&&!t.visible()){v(0,true)}}}).bind("search",function(){var A=(arguments.length>1)?arguments[1]:null;function B(F,E){var C;if(E&&E.length){for(var D=0;D<E.length;D++){if(E[D].result.toLowerCase()==F.toLowerCase()){C=E[D];break}}}if(typeof A=="function"){A(C)}else{b.trigger("result",C&&[C.data,C.value])}}a.each(i(b.val()),function(C,D){f(D,B,B)})}).bind("flushCache",function(){o.flush()}).bind("setOptions",function(){a.extend(true,h,arguments[1]);if("data" in arguments[1]){o.populate()}}).bind("unautocomplete",function(){t.unbind();b.unbind();a(n.form).unbind(".autocomplete")});function d(){var D=t.selected();if(!D){return false}var A=D.result;s=A;if(h.multiple){var G=i(b.val());if(G.length>1){var C=h.multipleSeparator.length;var F=a(n).selection().start;var E,B=0;a.each(G,function(H,I){B+=I.length;if(F<=B){E=H;return false}B+=C});G[E]=A;A=G.join(h.multipleSeparator)}A+=h.multipleSeparator}b.val(A);x();b.trigger("result",[D.data,D.value]);return true}function v(C,B){if(w==c.DEL){t.hide();return}var A=b.val();if(!B&&A==s){return}s=A;A=k(A);if(A.length>=h.minChars){b.addClass(h.loadingClass);if(!h.matchCase){A=A.toLowerCase()}f(A,m,x)}else{p();t.hide()}}function i(A){if(!A){return[""]}if(!h.multiple){return[a.trim(A)]}return a.map(A.split(h.multipleSeparator),function(B){return a.trim(A).length?a.trim(B):null})}function k(A){if(!h.multiple){return A}var C=i(A);if(C.length==1){return C[0]}var B=a(n).selection().start;if(B==A.length){C=i(A)}else{C=i(A.replace(A.substring(B),""))}return C[C.length-1]}function r(A,B){if(h.autoFill&&(k(b.val()).toLowerCase()==A.toLowerCase())&&w!=c.BACKSPACE){b.val(b.val()+B.substring(k(s).length));a(n).selection(s.length,s.length+B.length)}}function u(){clearTimeout(l);l=setTimeout(x,200)}function x(){var A=t.visible();t.hide();clearTimeout(l);p();if(h.mustMatch){b.search(function(B){if(!B){if(h.multiple){var C=i(b.val()).slice(0,-1);b.val(C.join(h.multipleSeparator)+(C.length?h.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function m(B,A){if(A&&A.length&&e){p();t.display(A,B);r(B,A[0].value);t.show()}else{x()}}function f(C,E,B){if(!h.matchCase){C=C.toLowerCase()}var D=o.load(C);if(D){if(D.length){E(C,D)}else{var A=h.parse&&h.parse(h.noRecord)||q(h.noRecord);E(C,A)}}else{if((typeof h.url=="string")&&(h.url.length>0)){var F={timestamp:+new Date()};a.each(h.extraParams,function(G,H){F[G]=typeof H=="function"?H():H});a.ajax({mode:"abort",port:"autocomplete"+n.name,dataType:h.dataType,url:h.url,data:a.extend({q:k(C),limit:h.max},F),success:function(H){var G=h.parse&&h.parse(H)||q(H);o.add(C,G);E(C,G)}})}else{t.emptyList();if(j!=null){j()}else{B(C)}}}}function q(D){var A=[];var C=D.split("\n");for(var B=0;B<C.length;B++){var E=a.trim(C[B]);if(E){E=E.split("|");A[A.length]={data:E,value:E[0],result:h.formatResult&&h.formatResult(E,E[0])||E[0]}}}return A}function p(){b.removeClass(h.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:100,max:1000,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:" ",inputFocus:true,clickFire:false,highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")
},scroll:true,scrollHeight:300,scrollJumpPosition:true};a.Autocompleter.Cache=function(c){var f={};var d=0;function i(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(c.matchContains=="word"){j=l.toLowerCase().search("\\b"+k.toLowerCase())}if(j==-1){return false}return j==0||c.matchContains}function h(k,j){if(d>c.cacheLength){b()}if(!f[k]){d++}f[k]=j}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(typeof(o)==="undefined"||o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;h(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:h,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(i(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(i(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.Autocompleter.Select=function(e,k,m,q){var j={ACTIVE:"ac_over"};var l,f=-1,s,n="",t=true,c,p;function o(){if(!t){return}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body).hover(function(u){if(a(this).is(":visible")){k.focus()}q.mouseDownOnSelect=false});p=a("<ul/>").appendTo(c).mouseover(function(u){if(r(u).nodeName&&r(u).nodeName.toUpperCase()=="LI"){f=a("li",p).removeClass(j.ACTIVE).index(r(u));a(r(u)).addClass(j.ACTIVE)}}).click(function(u){a(r(u)).addClass(j.ACTIVE);m();if(e.inputFocus){k.focus()}return false}).mousedown(function(){q.mouseDownOnSelect=true}).mouseup(function(){q.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}t=false}function r(v){var u=v.target;while(u&&u.tagName!="LI"){u=u.parentNode}if(!u){return[]}return u}function i(u){l.slice(f,f+1).removeClass(j.ACTIVE);h(u);var w=l.slice(f,f+1).addClass(j.ACTIVE);if(e.scroll){var v=0;l.slice(0,f).each(function(){v+=this.offsetHeight});if((v+w[0].offsetHeight-p.scrollTop())>p[0].clientHeight){p.scrollTop(v+w[0].offsetHeight-p.innerHeight())}else{if(v<p.scrollTop()){p.scrollTop(v)}}}}function h(u){if(e.scrollJumpPosition||(!e.scrollJumpPosition&&!((u<0&&f==0)||(u>0&&f==l.size()-1)))){f+=u;if(f<0){f=l.size()-1}else{if(f>=l.size()){f=0}}}}function b(u){return e.max&&e.max<u?e.max:u}function d(){p.empty();var v=b(s.length);for(var w=0;w<v;w++){if(!s[w]){continue}var x=e.formatItem(s[w].data,w+1,v,s[w].value,n);if(x===false){continue}var u=a("<li/>").html(e.highlight(x,n)).addClass(w%2==0?"ac_even":"ac_odd").appendTo(p)[0];a.data(u,"ac_data",s[w])}l=p.find("li");if(e.selectFirst){l.slice(0,1).addClass(j.ACTIVE);f=0}if(a.fn.bgiframe){p.bgiframe()}}return{display:function(v,u){o();s=v;n=u;d()},next:function(){i(1)},prev:function(){i(-1)},pageUp:function(){if(f!=0&&f-8<0){i(-f)}else{i(-8)}},pageDown:function(){if(f!=l.size()-1&&f+8>l.size()){i(l.size()-1-f)}else{i(8)}},hide:function(){c&&c.hide();l&&l.removeClass(j.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(l.filter("."+j.ACTIVE)[0]||e.selectFirst&&l[0])},show:function(){var w=a(k).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(k).width(),top:w.top+k.offsetHeight,left:w.left}).show();if(e.scroll){p.scrollTop(0);p.css({maxHeight:e.scrollHeight,overflow:"auto"});if(navigator.userAgent.indexOf("MSIE")!=-1&&typeof document.body.style.maxHeight==="undefined"){var u=0;l.each(function(){u+=this.offsetHeight});var v=u>e.scrollHeight;p.css("height",v?e.scrollHeight:u);if(!v){l.width(p.width()-parseInt(l.css("padding-left"))-parseInt(l.css("padding-right")))}}}},selected:function(){var u=l&&l.filter("."+j.ACTIVE).removeClass(j.ACTIVE);return u&&u.length&&a.data(u[0],"ac_data")},emptyList:function(){p&&p.empty()},unbind:function(){c&&c.remove()}}};a.fn.selection=function(j,b){if(j!==undefined){return this.each(function(){if(this.createTextRange){var k=this.createTextRange();if(b===undefined||j==b){k.move("character",j);k.select()}else{k.collapse(true);k.moveStart("character",j);k.moveEnd("character",b);k.select()}}else{if(this.setSelectionRange){this.setSelectionRange(j,b)}else{if(this.selectionStart){this.selectionStart=j;this.selectionEnd=b}}}})}var h=this[0];if(h.createTextRange){var c=document.selection.createRange(),i=h.value,f="<->",d=c.text.length;c.text=f;var e=h.value.indexOf(f);h.value=i;this.selection(e,e+d);return{start:e,end:e+d}}else{if(h.selectionStart!==undefined){return{start:h.selectionStart,end:h.selectionEnd}}}}})(jQuery);(function(a){a.PaginationCalculator=function(b,c){this.maxentries=b;this.opts=c};a.extend(a.PaginationCalculator.prototype,{numPages:function(){return Math.ceil(this.maxentries/this.opts.items_per_page)
},getInterval:function(f){var d=Math.floor(this.opts.num_display_entries/2);var e=this.numPages();var c=e-this.opts.num_display_entries;var h=f>d?Math.max(Math.min(f-d,c),0):0;var b=f>d?Math.min(f+d+(this.opts.num_display_entries%2),e):Math.min(this.opts.num_display_entries,e);return{start:h,end:b}}});a.PaginationRenderers={};a.PaginationRenderers.defaultRenderer=function(b,c){this.maxentries=b;this.opts=c;this.pc=new a.PaginationCalculator(b,c)};a.extend(a.PaginationRenderers.defaultRenderer.prototype,{createLink:function(b,e,d){var f,c=this.pc.numPages();b=b<0?0:(b<c?b:c-1);d=a.extend({text:b+1,classes:""},d||{});if(b==e){f=a("<a class='current'>"+d.text+"</a>")}else{f=a("<a>"+d.text+"</a>").attr("href",this.opts.link_to.replace(/__id__/,b+1))}if(d.classes){f.addClass(d.classes)}f.data("page_id",b);return f},appendRange:function(c,f,h,b,e){var d;for(d=h;d<b;d++){this.createLink(d,f,e).appendTo(c)}},getLinks:function(i,e){var f,b,c=this.pc.getInterval(i),h=this.pc.numPages(),d=a("<div class='pagination'></div>");if(this.opts.prev_text&&(i>0||this.opts.prev_show_always)){d.append(this.createLink(i-1,i,{text:this.opts.prev_text,classes:"prev"}))}if(c.start>0&&this.opts.num_edge_entries>0){b=Math.min(this.opts.num_edge_entries,c.start);this.appendRange(d,i,0,b,{classes:"sp"});if(this.opts.num_edge_entries<c.start&&this.opts.ellipse_text){a("<span class='pagination-break'>"+this.opts.ellipse_text+"</span>").appendTo(d)}}this.appendRange(d,i,c.start,c.end);if(c.end<h&&this.opts.num_edge_entries>0){if(h-this.opts.num_edge_entries>c.end&&this.opts.ellipse_text){a("<span class='pagination-break'>"+this.opts.ellipse_text+"</span>").appendTo(d)}f=Math.max(h-this.opts.num_edge_entries,c.end);this.appendRange(d,i,f,h,{classes:"ep"})}if(this.opts.next_text&&(i<h-1||this.opts.next_show_always)){d.append(this.createLink(i+1,i,{text:this.opts.next_text,classes:"next"}))}a("a",d).click(e);return d}});a.fn.pagination=function(j,b){b=a.extend({items_per_page:1,num_display_entries:4,current_page:0,num_edge_entries:1,link_to:"javascript:void(0)",prev_text:"<i></i>上一页",next_text:"下一页 <i></i>",ellipse_text:"...",prev_show_always:true,next_show_always:true,renderer:"defaultRenderer",show_if_single_page:false,load_first_page:false,callback:function(){return false}},b||{});var c=this,f,l,e;function d(n){var o,m=a(n.target).data("page_id"),p=h(m);if(!p){n.stopPropagation()}return p}function h(m){c.data("current_page",m);l=f.getLinks(m,d);c.empty();l.appendTo(c);var n=b.callback(m,c);return n}e=parseInt(b.current_page);c.data("current_page",e);j=(!j||j<0)?1:j;b.items_per_page=(!b.items_per_page||b.items_per_page<0)?1:b.items_per_page;if(!a.PaginationRenderers[b.renderer]){throw new ReferenceError("Pagination renderer '"+b.renderer+"' was not found in jQuery.PaginationRenderers object.")}f=new a.PaginationRenderers[b.renderer](j,b);var i=new a.PaginationCalculator(j,b);var k=i.numPages();c.bind("setPage",{numPages:k},function(n,m){if(m>=0&&m<n.data.numPages){h(m);return false}});c.bind("prevPage",function(m){var n=a(this).data("current_page");if(n>0){h(n-1)}return false});c.bind("nextPage",{numPages:k},function(m){var n=a(this).data("current_page");if(n<m.data.numPages-1){h(n+1)}return false});l=f.getLinks(e,d);c.empty();if(k>1||b.show_if_single_page){l.appendTo(c)}if(b.load_first_page){b.callback(e,c)}}})(jQuery);var MasterSlaveUtil={init:function(f){var d=getRealJqueryObject(f);if(!isOk(d)){return false}var e=this;var b=d.find(".jbolt_master_slave_box");if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){e.initHeight(b.eq(c))}},initMasterTableEvent:function(){var a=this;jboltBody.on("click",".jbolt_page .jbolt_master_slave_box .jbolt_master_container table.table>tbody>tr",function(){var e=$(this);e.parent().find("tr.active").removeClass("active");e.addClass("active");var f=e.data("id");if(!f){LayerMsgBox.alert("数据TR绑定data-id为空",2)}else{var d=LayerMsgBox.load(3);var b=e.closest(".jbolt_master_slave_box").find(".jbolt_slave_container [data-ajaxportal]");var c=b.length;if(b&&c){b.each(function(l){var h=$(this);var k=h.data("orign-url");if(!k){LayerMsgBox.alert("AjaxPortal组件需要设置data-orign-url属性",2)}else{var j=k+"/"+f;h.ajaxPortal(true,j,true,function(){if(l==c-1){LayerMsgBox.close(d)}a.initPortalHeight(h)})}})}}})},initPortalHeight:function(b){var a=b.closest(".jbolt_slave_container");if(a&&a.length>0){var c=a.outerHeight()-45;a.find(".jbolt_slave_body").each(function(){var d=$(this);var f=d.parent().find(".jbolt_slave_top");if(f&&f.length>0){var e=f.outerHeight();d.height(c-e)}else{d.height(c)}})}},initHeight:function(c){var a=mainPjaxContainer.height()-60;var b=mainPjaxContainer.find(".jbolt_page_title");if(b&&b.length>0){a=a-Math.ceil(b.height())}var d=mainPjaxContainer.find(".jbolt_page_content");if(d&&d.length>0){c.height(Math.floor(a))}}};function resizeJBoltLayer(){var b=jboltBody.find(".jbolt_layer_portal");if(b&&b.length==1){var i=b.closest("#jbolt_layer");if(i&&i.length==1){var h=i.data("triggerid");if(h){var d=$("#"+h);
if(d&&d.length==1){var a=d.data("height");if(a){var c=jboltWindowHeight-a;if(c<0){c=0}var f=c+"px";b.css({"top":f});var e=i.find(".jbolt_layer_close");if(e&&e.length==1){e.css({"top":f})}}}}}}}function onwindowReisze(){jboltWindow.on("resize",function(){MasterSlaveUtil.init(mainPjaxContainer);jboltWindowHeight=jboltWindow.height();resizeJBoltLayer()})}function toggleVisiable(c,b){if(b){$(c).toggle()}else{var a=isWithtabs();if(a){var d=JBoltTabUtil.getCurrentTabContent();if(d&&d.length==1){d.find(c).toggle()}}else{$(mainPjaxContainer).find(c).toggle()}}}var lockHtmlTpl='<div oncontextmenu="doNothing()" class="j_locksystem noselect" id="j_locksystem">'+'<div class="j_lockmain"><h1>屏幕已锁</h1><div class="j_lockpassword">'+'<input onkeyup="unlockSystem(event)" maxlength="40" type="password" id="unlockpwd" placeholder="请在此处，输入登录密码" name="password"  autocomplete="off" /></div></div></div>';var lockSystemTimer;function checkLockSystem(){console.log("checkLockSystem");var a=$("#j_locksystem");if(a&&a.length==1){a.removeClass("__web-inspector-hide-shortcut__");a.show()}else{showJBoltLockSystemEle()}}function showJboltLockSystem(){showJBoltLockSystemEle();lockSystemTimer=setInterval(checkLockSystem,600)}function showJBoltLockSystemEle(){console.log("调用显示");if(self!=top){parent.showJboltLockSystem()}else{var a=$("#j_locksystem");if(!(a&&a.length==1)){jboltBody.append(lockHtmlTpl);a=$("#j_locksystem")}$("#unlockpwd").val("");a.removeClass("__web-inspector-hide-shortcut__");a.fadeIn(300)}}function unlockSystem(a){var c=a.keyCode?a.keyCode:a.which?a.which:a.charCode;if(c==13){var b=$("#unlockpwd").val();if(!($.trim(b))){LayerMsgBox.alert("请输入登录密码",2)}else{LayerMsgBox.loading("解锁中...",10000);Ajax.post("/admin/unLockSystem",{"password":b},function(d){LayerMsgBox.success("解锁成功",500,closeJboltLockSystem)})}}}function closeJboltLockSystem(){if(self!=top){parent.closeJboltLockSystem()}else{console.log("调用关闭");clearInterval(lockSystemTimer);var a=$(".jbolt_admin");if(a&&a.length==1){$("#unlockpwd").val("");$("#j_locksystem").fadeOut(300)}else{reloadCurrentPage()}}}function doNothing(){window.event.returnValue=false;return false}function initToolTip(b){var c;if(b){var a=getRealJqueryObject(b);if(isOk(a)){c=a.find("[tooltip],[data-toggle='tooltip']")}}else{c=jboltBody.find("[tooltip],[data-toggle='tooltip']")}if(c&&c.length>0){c.tooltip()}}function changeUserJboltStyle(d){var j=$("#jbolt_user_config_style_box");j.find(".jbolt_config_style.active").removeClass("active");j.find("#jbs_"+d).addClass("active");var a=$(".jbolt_admin");var e=a[0].className;var h=e.split(" ");var b="";var f="";for(var c in h){f=h[c];if(f!="default"&&f.indexOf("jbolt_style_")==-1){b=b+f+" "}}a[0].className=b+d}function initLoginStyle(){var b=$.cookie("jbolt_login_glassStyle");var a=$.cookie("jbolt_login_bgimgBlur");if(b&&b=="true"){$(".jbolt_loginform").addClass("jbolt_bg_glass")}else{$(".jbolt_loginform").removeClass("jbolt_bg_glass")}if(a&&a=="true"){$(".bodybgmask").addClass("blur")}else{$(".bodybgmask").removeClass("blur")}setTimeout(function(){$(".jbolt_formbox").addClass("show");$(".jbolt_title").addClass("show")},300)}var Select2Util={init:function(a){this.initNotAutoLoadSelect(a)},initNotAutoLoadSelect:function(c){if(hasImportSelect2){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("select[data-select2]:not([data-autoload]):not([data-linkage])");if(!isOk(a)){return false}a.select2()}},initAutoLoadSelect:function(a){if(hasImportSelect2){var b=a.data("select-type");if(b&&b=="select2"){var c=a.data("placeholder");if(!c){c=a.attr("placeholder");if(!c){c=a.data("text");if(!c){c="请选择"}}}a.select2({theme:"bootstrap",allowClear:true,placeholder:c})}}}};function checkImportSelect2(){var a=$("script[src*='select2']");return(a&&a.length==1)}function processGlobalSelect2(){hasImportSelect2=checkImportSelect2();if(hasImportSelect2){$.fn.modal.Constructor.prototype.enforceFocus=function(){};$.fn.select2.defaults.set("width","100%");$.fn.select2.defaults.set("theme","bootstrap")}}function initAjaxPortal(c){var a;if(c){var b=getRealJqueryObject(c);if(isOk(b)){a=b.find("[data-ajaxportal]")}}else{a=jboltBody.find("[data-ajaxportal]")}if(a&&a.length>0){a.ajaxPortal(true)}}function processImgviewerEvent(){jboltBody.on("click",".viewer-canvas",function(a){if($(a.target).hasClass("viewer-canvas")){$(".viewer-close").trigger("click")}})}$.getMultiScripts=function(a,c){var b=$.map(a,function(d){return $.ajax({async:false,dataType:"script",url:((c||"")+d)})});b.push($.Deferred(function(d){$(d.resolve)}));return $.when.apply($,b)};function initJboltAdmin(){initAdminLeftNav();processGlobalSelect2();TableUtil.init();PageOptUtil.init();toggleMenuEvent();JBoltLayerUtil.init();MasterSlaveUtil.initMasterTableEvent();processImgviewerEvent();initJboltAdminTopStyleChange();LayerPhotoUtil.init()}function isHasPjax(){var a=$("#pjaxScript");return a&&a.length==1}var MultipleFileInputUtil={init:function(c){var b=getRealJqueryObject(c);if(!isOk(b)){return false}var a=b.find("[data-multiplefileinput]");
if(!isOk(a)){return false}this.initInputs(a)},initInputs:function(b){if(!isOk(b)){return false}var a=b.length;for(var c=0;c<a;c++){this.initInput(b.eq(c))}},processHandler:function(handler,res){var exe_handler=eval(handler);if(exe_handler&&typeof(exe_handler)=="function"){exe_handler(res)}},initEvent:function(input){var that=this;var handler=input.data("handler");if(handler){var sync=input.data("sync");if(sync){input.on("filebatchuploadsuccess",function(event,data,previewId,index){that.processHandler(handler,data.response)})}else{input.on("fileuploaded",function(event,data,previewId,index){that.processHandler(handler,data.response)})}}var extraHandler=input.data("extrahandler");if(extraHandler){var exeextra_handler=eval(extraHandler);if(exeextra_handler&&typeof(exeextra_handler)=="function"){exeextra_handler(input)}}},initInput:function(k){var c=k.data("choosebtntext");if(!c){c="请选择"}var h=k.data("max-filecount");if(!h){h=9}var d=k.data("max-filesize");if(!d){d=200}var e=k.data("theme");if(!e){e="fa"}var i=k.data("sync");var f=true;if(i){f=false}var j=k.data("uploadurl");if(!j){LayerMsgBox.alert("请设置多文件组件上传地址：data-uploadurl",2)}var m={enctype:"multipart/form-data",previewFileType:"image",theme:e,uploadAsync:f,allowedPreviewTypes:["image"],uploadUrl:j,maxFileCount:h,maxFileSize:d,showSort:true,showCaption:false,showCancel:false,language:"zh",browseClass:"btn btn-success",browseLabel:c,removeClass:"btn btn-danger",removeLabel:"清空",uploadClass:"btn btn-info",uploadLabel:"全部上传",fileActionSettings:{showRemove:true,showUpload:false,showDownload:false,showZoom:true,showDrag:true,}};var l=k.attr("id");var b=k.closest(".file-input");if(b&&b.length==1){var a=k.clone();b.before(a);b.remove();a.fileinput(m);this.initEvent(a)}else{k.fileinput(m);this.initEvent(k)}}};$(function(){var a=isHasPjax();var c=isWithtabs();initJboltAdmin();if(needPjax&&a){if(c){JBoltTabUtil.init();JBoltTabUtil.addJboltTabWithoutContentUrl();var b=JBoltTabUtil.getCurrentTabContent();if(b&&b.length==1){afterAjaxPortal(b)}initAdminAjaxPortalFormSubmitEvent()}else{initAdminPjax()}}else{if(c){JBoltTabUtil.init();initAdminAjaxPortalFormSubmitEvent()}SelectUtil.initAutoSetValue();JAtomFileUploadUtil.init();JAtomImgUploader.init();SwitchBtnUtil.init();FormDate.init();LayerTipsUtil.init();HtmlEditorUtil.init();ImageViewerUtil.init();AutocompleteUtil.init();RadioUtil.init();CheckboxUtil.init();Select2Util.init();SelectUtil.init();initToolTip();MultipleFileInputUtil.init();initAjaxPortal()}onwindowReisze()});